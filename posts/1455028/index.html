<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Openeuler开箱指南 - Fermi</title><meta name=author content><meta name=description content="welcome to femris的博客网站!"><meta name=keywords content='draft'><meta itemprop=name content="openeuler开箱指南"><meta itemprop=description content="welcome to femris的博客网站!"><meta itemprop=datePublished content="2025-12-22T06:30:06+08:00"><meta itemprop=dateModified content="2025-12-22T06:30:06+08:00"><meta itemprop=wordCount content="4037"><meta itemprop=keywords content="Draft"><meta property="og:url" content="https://jiang1bo.github.io/posts/1455028/"><meta property="og:site_name" content="Fermi"><meta property="og:title" content="openeuler开箱指南"><meta property="og:description" content="welcome to femris的博客网站!"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-12-22T06:30:06+08:00"><meta property="article:modified_time" content="2025-12-22T06:30:06+08:00"><meta property="article:tag" content="Draft"><meta name=twitter:card content="summary"><meta name=twitter:title content="openeuler开箱指南"><meta name=twitter:description content="welcome to femris的博客网站!"><meta name=application-name content="Fermi's Blog"><meta name=apple-mobile-web-app-title content="Fermi's Blog"><meta name=theme-color data-light=#ffffff data-dark=#ffffff content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=favicon.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical type=text/html href=https://jiang1bo.github.io/posts/1455028/ title="openeuler开箱指南 - Fermi"><link rel=prev type=text/html href=https://jiang1bo.github.io/posts/e7d8135/ title="Markdown 语法示例"><link rel=next type=text/html href=https://jiang1bo.github.io/posts/9c9909b/ title=Wireshark><link rel=alternate type=text/markdown href=https://jiang1bo.github.io/posts/1455028/index.md title="openeuler开箱指南 - Fermi"><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"openeuler开箱指南","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/jiang1bo.github.io\/posts\/1455028\/"},"genre":"posts","keywords":"draft","wordcount":4037,"url":"https:\/\/jiang1bo.github.io\/posts\/1455028\/","datePublished":"2025-12-22T06:30:06+08:00","dateModified":"2025-12-22T06:30:06+08:00","publisher":{"@type":"Organization","name":""},"description":""}</script><script src=/js/head/color-scheme.min.js></script></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=/ title=Fermi><span class=header-title-text>Fermi's Blog</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> Archives</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> Categories</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=Fermi><span class=header-title-text>Fermi's Blog</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> Archives</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> Categories</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=合集></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span title=转载 class=icon-repost><i class="fa-solid fa-share fa-fw" aria-hidden=true></i></span><span>Openeuler开箱指南</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><i class="fa-solid fa-user-circle" aria-hidden=true></i>
Anonymous</span></span><span class=post-included-in>&nbsp;收录于 <a href=/categories/draft/ class=post-category title="分类 - Draft"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Draft</a></span></div><div class=post-meta-line><span title="发布于 2025-12-22 06:30:06"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2025-12-22>2025-12-22</time></span>&nbsp;<span title="4037 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 4100 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 19 分钟</span>&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title=Openeuler开箱指南><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_page_pv>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#查看系统信息>查看系统信息</a><ul><li><a href=#系统升降级>系统升，降级</a></li></ul></li><li><a href=#查看硬件信息>查看硬件信息</a></li><li><a href=#查看软件信息>查看软件信息</a></li><li><a href=#查看os日志>查看OS日志</a></li></ul><ul><li><a href=#配置网络>配置网络</a></li><li><a href=#管理rpm包>管理RPM包</a><ul><li><a href=#操作9-卸载一个或多个软件包><strong>操作9. 卸载一个或多个软件包</strong></a></li></ul></li><li><a href=#配置ssh>配置SSH</a></li></ul><ul><li><a href=#配置-ip>配置 IP</a><ul><li><a href=#使用nmcli命令>使用nmcli命令</a><ul><li><a href=#nmcli介绍>nmcli介绍</a></li><li><a href=#设备管理>设备管理</a><ul><li><a href=#连接到设备>连接到设备</a></li><li><a href=#断开设备连接>断开设备连接</a></li></ul></li><li><a href=#设置网络连接>设置网络连接</a><ul><li><a href=#配置动态ip连接>配置动态IP连接</a><ul><li><a href=#配置ip>配置IP</a></li><li><a href=#激活连接并检查状态>激活连接并检查状态</a></li></ul></li><li><a href=#配置静态ip连接>配置静态IP连接</a><ul><li><a href=#配置ip-1>配置IP</a></li><li><a href=#激活连接并检查状态-1>激活连接并检查状态</a></li></ul></li><li><a href=#添加-wi-fi-连接>添加 Wi-Fi 连接</a><ul><li><a href=#方法1-通过网络接口连接wifi>方法1. 通过网络接口连接wifi</a></li><li><a href=#方法2-通过配置文件连接wi-fi>方法2. 通过配置文件连接Wi-Fi</a></li></ul></li><li><a href=#更改属性>更改属性</a></li></ul></li><li><a href=#配置静态路由>配置静态路由</a></li></ul></li><li><a href=#使用ip命令>使用ip命令</a><ul><li><a href=#配置ip地址>配置IP地址</a><ul><li><a href=#配置静态地址>配置静态地址</a></li><li><a href=#配置多个地址>配置多个地址</a></li></ul></li><li><a href=#配置静态路由-1>配置静态路由</a></li></ul></li><li><a href=#通过ifcfg文件配置网络>通过ifcfg文件配置网络</a><ul><li><a href=#配置静态网络>配置静态网络</a></li><li><a href=#配置动态网络>配置动态网络</a></li><li><a href=#配置默认网关>配置默认网关</a></li></ul></li><li><a href=#通过-nmtui-工具>通过 nmtui 工具</a></li></ul></li><li><a href=#配置主机名>配置主机名</a><ul><li><a href=#简介>简介</a></li><li><a href=#使用hostnamectl配置主机名>使用hostnamectl配置主机名</a><ul><li><a href=#查看所有主机名>查看所有主机名</a></li><li><a href=#设定所有主机名>设定所有主机名</a></li><li><a href=#设定特定主机名>设定特定主机名</a></li><li><a href=#清除特定主机名>清除特定主机名</a></li><li><a href=#远程更改主机名>远程更改主机名</a></li></ul></li><li><a href=#使用nmcli配置主机名>使用nmcli配置主机名</a></li><li><a href=#通过-nmtui-工具-1>通过 nmtui 工具</a></li></ul></li><li><a href=#配置网络绑定>配置网络绑定</a><ul><li><a href=#使用nmcli>使用nmcli</a></li><li><a href=#使用命令行>使用命令行</a><ul><li><a href=#检查是否已安装bonding内核模块>检查是否已安装Bonding内核模块</a></li><li><a href=#创建频道绑定接口>创建频道绑定接口</a></li><li><a href=#创建从属接口>创建从属接口</a></li><li><a href=#激活频道绑定>激活频道绑定</a></li><li><a href=#创建多个绑定>创建多个绑定</a></li></ul></li><li><a href=#使用-nmtui-工具>使用 nmtui 工具</a></li></ul></li><li><a href=#ipv6使用差异说明vs-ipv4>IPv6使用差异说明（vs IPv4）</a><ul><li><a href=#配置说明>配置说明</a><ul><li><a href=#设置接口设备mtu值>设置接口设备MTU值</a><ul><li><a href=#概述>概述</a></li><li><a href=#设置接口设备的mtu>设置接口设备的mtu</a></li></ul></li><li><a href=#有状态自动配置ipv6地址>有状态自动配置IPv6地址</a><ul><li><a href=#概述-1>概述</a></li><li><a href=#有状态自动配置ipv6地址时dhclient设置vendor-class方法>有状态自动配置IPv6地址时dhclient设置vendor class方法</a></li></ul></li><li><a href=#内核支持socket相关系统调用>内核支持socket相关系统调用</a><ul><li><a href=#概述-2>概述</a></li><li><a href=#link-local地址和global地址在socket调用时的差异>link-local地址和global地址在socket调用时的差异</a></li></ul></li><li><a href=#ipv4的dhclient守护进程持久化配置>IPv4的dhclient守护进程持久化配置</a><ul><li><a href=#概述-3>概述</a></li><li><a href=#约束限制>约束限制</a></li><li><a href=#ipv4-dhcp和ipv6-dhcpv6方式获取地址的配置差异>IPv4 DHCP和IPv6 DHCPv6方式获取地址的配置差异</a></li></ul></li><li><a href=#iproute相关命令配置ipv4与ipv6时的差异说明>iproute相关命令配置IPv4与IPv6时的差异说明</a><ul><li><a href=#概述-4>概述</a></li><li><a href=#ipv6地址的生命周期>IPv6地址的生命周期</a></li><li><a href=#ip-link-命令>ip link 命令</a></li><li><a href=#ip-addr命令>ip addr命令</a></li><li><a href=#ip-route命令>ip route命令</a></li><li><a href=#ip-rule命令>ip rule命令</a></li></ul></li><li><a href=#networkmanager服务配置差异说明>NetworkManager服务配置差异说明</a><ul><li><a href=#概述-5>概述</a></li><li><a href=#配置差异说明>配置差异说明</a></li></ul></li></ul></li><li><a href=#faq>FAQ</a><ul><li><a href=#iscsi-initiator-utils不支持登录fe80-ipv6地址>iscsi-initiator-utils不支持登录fe80 IPv6地址</a><ul><li><a href=#问题现象>问题现象</a></li><li><a href=#原因分析>原因分析</a></li></ul></li><li><a href=#网卡down掉之后ipv6地址丢失>网卡down掉之后，IPv6地址丢失</a><ul><li><a href=#问题现象-1>问题现象</a></li><li><a href=#原因分析-1>原因分析</a></li></ul></li><li><a href=#bond口已具有多个ipv6地址时添加或删除ipv6地址耗时过久>bond口已具有多个IPv6地址时，添加或删除IPv6地址耗时过久</a><ul><li><a href=#问题现象-2>问题现象</a></li><li><a href=#原因分析-2>原因分析</a></li><li><a href=#解决方法>解决方法</a></li></ul></li><li><a href=#rsyslog在ipv4和ipv6混合使用场景中日志传输延迟>Rsyslog在IPv4和IPv6混合使用场景中日志传输延迟</a><ul><li><a href=#问题现象-3>问题现象</a></li><li><a href=#原因分析-3>原因分析</a></li><li><a href=#解决方法-1>解决方法</a></li></ul></li></ul></li></ul></li><li><a href=#系统资源性能查看>系统资源性能查看</a></li><li><a href=#cpu>CPU</a><ul><li><a href=#基本概念>基本概念</a></li><li><a href=#常用cpu性能分析工具>常用CPU性能分析工具</a></li></ul></li><li><a href=#内存>内存</a><ul><li><a href=#基本概念-1>基本概念</a></li><li><a href=#常用内存分析工具方式>常用内存分析工具/方式</a></li></ul></li><li><a href=#io>I/O</a><ul><li><a href=#基本概念-2>基本概念</a></li><li><a href=#常用io性能分析工具>常用I/O性能分析工具</a></li></ul></li></ul></nav></div></div><div class=content id=content><h2 class=heading-element id=查看系统信息><span>查看系统信息</span>
<a href=#%e6%9f%a5%e7%9c%8b%e7%b3%bb%e7%bb%9f%e4%bf%a1%e6%81%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1>#查看操作系统版本信息</span>
</span></span><span class=line><span class=cl> cat /etc/openEuler-latest
</span></span><span class=line><span class=cl> cat /etc/os-release
</span></span><span class=line><span class=cl> cat /etc/openEuler-release
</span></span><span class=line><span class=cl><span class=c1>#查看操作系统版本信息</span>
</span></span><span class=line><span class=cl> uname -a
</span></span><span class=line><span class=cl><span class=c1>#备份yum源</span>
</span></span><span class=line><span class=cl> cp /etc/yum.repos.d/openEuler.repo /etc/yum.repos.d/openEuler.repo.bak</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=系统升降级><span>系统升，降级</span>
<a href=#%e7%b3%bb%e7%bb%9f%e5%8d%87%e9%99%8d%e7%ba%a7 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1>#系统升级</span>
</span></span><span class=line><span class=cl>dnf update <span class=p>|</span> tee update_log
</span></span><span class=line><span class=cl>reboot
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#系统降级</span>
</span></span><span class=line><span class=cl>dnf downgrade <span class=p>|</span> tee downgrade_log
</span></span><span class=line><span class=cl>reboot</span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=查看硬件信息><span>查看硬件信息</span>
<a href=#%e6%9f%a5%e7%9c%8b%e7%a1%ac%e4%bb%b6%e4%bf%a1%e6%81%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><ol><li><p>查看cpu的统计信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># lscpu</span></span></code></pre></td></tr></table></div></div></li><li><p>查看CPU相关参数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># cat /proc/cpuinfo</span></span></code></pre></td></tr></table></div></div></li><li><p>查看系统内存信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># cat /proc/meminfo</span></span></code></pre></td></tr></table></div></div></li><li><p>查看内存信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># dmidecode -t memory</span></span></code></pre></td></tr></table></div></div></li><li><p>查看硬盘和分区分布</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># lsblk</span></span></code></pre></td></tr></table></div></div></li><li><p>看硬盘和分区的详细信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># fdisk -l</span></span></code></pre></td></tr></table></div></div></li><li><p>查看网卡硬件信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># lspci | grep -i &#39;eth&#39;</span></span></code></pre></td></tr></table></div></div></li><li><p>查看所有网络接口</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># ip a</span>
</span></span><span class=line><span class=cl><span class=c1># yum install -y net-tools</span>
</span></span><span class=line><span class=cl><span class=c1># ifconfig</span></span></span></code></pre></td></tr></table></div></div></li><li><p>查看某个网络接口的详细信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># ethtool enp7s0 （以enp7s0为例）</span></span></span></code></pre></td></tr></table></div></div></li><li><p>查看pci信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># lspci</span></span></code></pre></td></tr></table></div></div></li><li><p>查看设备树</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># lspci -t</span></span></code></pre></td></tr></table></div></div></li><li><p>查看bios信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># dmidecode -t bios</span></span></code></pre></td></tr></table></div></div></li></ol><h2 class=heading-element id=查看软件信息><span>查看软件信息</span>
<a href=#%e6%9f%a5%e7%9c%8b%e8%bd%af%e4%bb%b6%e4%bf%a1%e6%81%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><ol><li><p>查看软件包的详细信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># rpm -qi systemd（以systemd为例）</span></span></code></pre></td></tr></table></div></div></li><li><p>查看软件包提供的模块</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># rpm -q --provides systemd  （以systemd为例）</span></span></code></pre></td></tr></table></div></div></li><li><p>查看所有已安装软件包</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># rpm -qa | grep systemd （以systemd为例）</span></span></code></pre></td></tr></table></div></div></li><li><p>查看软件包文件列表</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># rpm -ql python3-rpm  （以python3-rpm为例）</span></span></code></pre></td></tr></table></div></div></li></ol><h2 class=heading-element id=查看os日志><span>查看OS日志</span>
<a href=#%e6%9f%a5%e7%9c%8bos%e6%97%a5%e5%bf%97 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><ol><li><p>查看系统启动后的信息和错误日志</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># cat  /var/log/messages</span></span></span></code></pre></td></tr></table></div></div></li><li><p>查看安全相关的日志信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># cat /var/log/secure</span></span></span></code></pre></td></tr></table></div></div></li><li><p>查看邮件相关的日志信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># cat /var/log/maillog</span></span></span></code></pre></td></tr></table></div></div></li><li><p>查看定时任务相关的日志信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># cat /var/log/cron</span></span></span></code></pre></td></tr></table></div></div></li><li><p>查看UUCP和news设备相关的日志信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># cat /var/log/spooler</span></span></span></code></pre></td></tr></table></div></div></li><li><p>查看守护进程启动和停止相关的日志消息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># cat /var/log/boot.log</span></span></span></code></pre></td></tr></table></div></div></li></ol><h2 class=heading-element id=常用技能><span>常用技能</span>
<a href=#%e5%b8%b8%e7%94%a8%e6%8a%80%e8%83%bd class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h2 class=heading-element id=配置网络><span>配置网络</span>
<a href=#%e9%85%8d%e7%bd%ae%e7%bd%91%e7%bb%9c class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><ol><li>配置IP地址</li></ol><p>使用IP命令为接口配置地址，<strong>interface-name</strong>为网卡名称。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ip addr [ add | del ] address dev interface-name</span></span></code></pre></td></tr></table></div></div><ol><li>配置静态地址</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 配置静态IP地址
</span></span><span class=line><span class=cl>ip address add 192.168.0.10/24 dev enp3s0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 查看配置结果，在root权限使用如下命令
</span></span><span class=line><span class=cl>ip addr show dev enp3s0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 结果如下
</span></span><span class=line><span class=cl>2: enp3s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
</span></span><span class=line><span class=cl>link/ether 52:54:00:aa:ad:4a brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>inet 192.168.202.248/16 brd 192.168.255.255 scope global dynamic noprefixroute enp3s0
</span></span><span class=line><span class=cl>valid_lft 9547sec preferred_lft 9547sec
</span></span><span class=line><span class=cl>inet 192.168.0.10/24 scope global enp3s0
</span></span><span class=line><span class=cl>valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>inet6 fe80::32e8:cc22:9db2:f4d4/64 scope link noprefixroute
</span></span><span class=line><span class=cl>valid_lft forever preferred_lft forever</span></span></code></pre></td></tr></table></div></div><ol><li>配置静态路由</li></ol><p>静态路由，可使用 <code>ip route add</code> 命令<strong>在路由表中添加</strong>，使用 <code>ip route del</code> 命令删除。常用的 <code>ip route</code> 命令格式如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ip route [ add | del | change | append | replace ] destination-address</span></span></code></pre></td></tr></table></div></div><ul><li><strong>在主机地址中添加一个静态路由</strong>，在 root 权限下，使用以下命令格式：</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ip route add 192.168.2.1 via 10.0.0.1 [dev interface-name]</span></span></code></pre></td></tr></table></div></div><ul><li><strong>在网络中添加一个静态路由</strong>，在root权限下运行以下命令格式：</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ip route add 192.168.2.0/24 via 10.0.0.1 [dev interface-name]</span></span></code></pre></td></tr></table></div></div><ol><li>通过ifcfg文件配置网络</li></ol><p>通过在root权限下<strong>修改ifcfg文件</strong>实现，在/etc/sysconfig/network-scripts/目录中生成名为ifcfg-enp4s0的文件中，修改参数配置，示例如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>TYPE=Ethernet
</span></span><span class=line><span class=cl>PROXY_METHOD=none
</span></span><span class=line><span class=cl>BROWSER_ONLY=no
</span></span><span class=line><span class=cl>BOOTPROTO=none
</span></span><span class=line><span class=cl>IPADDR=192.168.0.10
</span></span><span class=line><span class=cl>PREFIX=24
</span></span><span class=line><span class=cl>DEFROUTE=yes
</span></span><span class=line><span class=cl>IPV4_FAILURE_FATAL=no
</span></span><span class=line><span class=cl>IPV6INIT=yes
</span></span><span class=line><span class=cl>IPV6_AUTOCONF=yes
</span></span><span class=line><span class=cl>IPV6_DEFROUTE=yes
</span></span><span class=line><span class=cl>IPV6_FAILURE_FATAL=no
</span></span><span class=line><span class=cl>IPV6_ADDR_GEN_MODE=stable-privacy
</span></span><span class=line><span class=cl>NAME=enp4s0static
</span></span><span class=line><span class=cl>UUID=xx
</span></span><span class=line><span class=cl>DEVICE=enp4s0
</span></span><span class=line><span class=cl>ONBOOT=yes</span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=管理rpm包><span>管理RPM包</span>
<a href=#%e7%ae%a1%e7%90%86rpm%e5%8c%85 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p><strong>RPM</strong>的全名是<strong>Red Hat Package Manager</strong>，本意是Red Hat 软件包管理。在<strong>openEuler、Fedora 、Redhat、Mandriva、SuSE、YellowDog</strong>等主流发行版本，以及在这些版本基础上二次开发出来的发行版采用。</p><p><strong>RPM</strong>以数据库记录的方式将需要的软件安装到Linux主机的一套管理程序，特点是将要安装的软件<strong>先编译并打包</strong>，通过包装好的软件中默认的数据库记录，记录这个软件在安装的时候需要的依赖属性模块，在用户的Linux主机安装时，<strong>RPM</strong>会先根据软件里的记录数据，查询Linux主机的依赖属性软件是否满足：</p><ul><li>若满足则予以安装。</li><li>若不满足则不安装。</li></ul><p>安装时将该软件的信息全部写入RPM的数据库中以便后续查询、验证与卸载。</p><p><img loading=lazy src=https://docs.openeuler.openatom.cn/assets/24.03_LTS_SP1/en-us_other_0000001337581224.X3EFnMLl.jpeg alt=zh-cn_other_0000001337581224></p><ol><li>rpm包默认安装路径</li></ol><p>通常情况下，<strong>RPM</strong>采用系统默认的安装路径（默认安装路径可以通过命令查询，后续章节中将会详细介绍），所有安装文件都会按照类别分散到如下表格所示的目录中。</p><p><strong>表 1</strong> RPM安装路径及其含义</p><table><thead><tr><th style=text-align:left>安装路径</th><th style=text-align:left>含义</th></tr></thead><tbody><tr><td style=text-align:left>/etc/</td><td style=text-align:left>配置文件安装目录。</td></tr><tr><td style=text-align:left>/usr/bin/</td><td style=text-align:left>可执行命令安装目录。</td></tr><tr><td style=text-align:left>/usr/lib/</td><td style=text-align:left>程序所使用的函数库保存位置。</td></tr><tr><td style=text-align:left>/usr/share/doc</td><td style=text-align:left>基本软件使用手册保存位置。</td></tr><tr><td style=text-align:left>/usr/share/man/</td><td style=text-align:left>帮助文件保存位置。</td></tr></tbody></table><p><strong>注意:</strong> RPM包支持手动指定安装路径，但此方式不推荐使用。通过手动指定安装路径后，所有的安装文件会集中安装到指定位置，且系统中用来查询安装路径的命令也无法使用（需手动配置才能被系统识别）。</p><ol><li>rpm命令选项</li></ol><p><strong>操作1. 软件包RPM签名检查</strong></p><p>Linux机器安装RPM包之前，需要检查PGP签名，确保签名的完整性和来源无问题后，使用RPM命令中的以下选项来验证有效性。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>rpm --checksig nano-2.3.1-10.el7.x86_64.rpm</span></span></code></pre></td></tr></table></div></div><p><strong>操作2. 安装RPM包</strong></p><p>Linux系统中安装RPM包时，请在rpm命令中使用 <strong>-i</strong> 选项。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>rpm -ivh nano-2.3.1-10.el7.x86_64.rpm</span></span></code></pre></td></tr></table></div></div><ul><li><strong>-i</strong> : 安装软件包</li><li><strong>-v</strong>: 详细信息</li><li><strong>-h</strong>: 套件安装时列出标记</li></ul><p><strong>操作3. 查询已安装的RPM包</strong></p><p>查询Linux系统中已经安装的RPM包（dnf），可以在rpm命令中使用 <strong>-q</strong> 选项。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>rpm -q dnf</span></span></code></pre></td></tr></table></div></div><ul><li><strong>-q:</strong> 查询操作</li></ul><p>如果系统未安装给定的包，会出现以下错误信息。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=err>#</span><span class=w> </span><span class=nx>rpm</span><span class=w> </span><span class=o>-</span><span class=nx>q</span><span class=w> </span><span class=nx>dnf</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>package</span><span class=w> </span><span class=nx>dnf</span><span class=w> </span><span class=nx>is</span><span class=w> </span><span class=nx>not</span><span class=w> </span><span class=nx>installed</span></span></span></code></pre></td></tr></table></div></div><p><strong>操作4. 查询所有已安装的RPM包</strong></p><p>查询Linux系统中安装的所有RPM包，请在rpm命令中使用 <strong>-qa</strong> 选项。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># rpm -qa 
</span></span><span class=line><span class=cl>dracut-config-rescue-055-7.oe2203sp2.x86_64
</span></span><span class=line><span class=cl>parted-3.5-1.oe2203sp2.x86_64
</span></span><span class=line><span class=cl>irqbalance-1.8.0-9.oe2203sp2.x86_64
</span></span><span class=line><span class=cl>......</span></span></code></pre></td></tr></table></div></div><p><strong>注意</strong>：一般在使用 <strong>-qa</strong> 选项时，会配合管道符 “|” 一起使用，提升查找的准确率。</p><p><strong>操作5. 查看已安装的RPM包详细信息</strong></p><p>在rpm命令中使用 <strong>-qi</strong> 选项来验证系统中安装的RPM包的详细信息。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># rpm -qi python3</span>
</span></span><span class=line><span class=cl><span class=n>Name</span>        <span class=p>:</span> <span class=n>python3</span>
</span></span><span class=line><span class=cl><span class=n>Version</span>     <span class=p>:</span> <span class=mf>3.9</span><span class=o>.</span><span class=mi>9</span>
</span></span><span class=line><span class=cl><span class=n>Release</span>     <span class=p>:</span> <span class=mf>24.</span><span class=n>oe2203sp2</span>
</span></span><span class=line><span class=cl><span class=n>Architecture</span><span class=p>:</span> <span class=n>x86_64</span>
</span></span><span class=line><span class=cl><span class=n>Install</span> <span class=n>Date</span><span class=p>:</span> <span class=n>Wed</span> <span class=mi>30</span> <span class=n>Mar</span> <span class=mi>2022</span> <span class=mi>08</span><span class=p>:</span><span class=mi>30</span><span class=p>:</span><span class=mi>23</span> <span class=n>AM</span> <span class=n>UTC</span>
</span></span><span class=line><span class=cl><span class=n>Group</span>       <span class=p>:</span> <span class=n>Unspecified</span>
</span></span><span class=line><span class=cl><span class=n>Size</span>        <span class=p>:</span> <span class=mi>35916839</span>
</span></span><span class=line><span class=cl><span class=n>License</span>     <span class=p>:</span> <span class=n>Python</span>
</span></span><span class=line><span class=cl><span class=n>Signature</span>   <span class=p>:</span> <span class=n>RSA</span><span class=o>/</span><span class=n>SHA1</span><span class=p>,</span> <span class=n>Wed</span> <span class=mi>30</span> <span class=n>Mar</span> <span class=mi>2022</span> <span class=mi>03</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>30</span> <span class=n>AM</span> <span class=n>UTC</span><span class=p>,</span> <span class=n>Key</span> <span class=n>ID</span> <span class=n>d557065eb25e7f66</span>
</span></span><span class=line><span class=cl><span class=n>Source</span> <span class=n>RPM</span>  <span class=p>:</span> <span class=n>python3</span><span class=o>-</span><span class=mf>3.9</span><span class=o>.</span><span class=mi>9</span><span class=o>-</span><span class=mf>24.</span><span class=n>oe2203sp2</span><span class=o>.</span><span class=n>x86_64</span><span class=o>.</span><span class=n>rpm</span>
</span></span><span class=line><span class=cl><span class=n>Build</span> <span class=n>Date</span>  <span class=p>:</span> <span class=n>Tue</span> <span class=mi>15</span> <span class=n>Mar</span> <span class=mi>2022</span> <span class=mi>12</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>00</span> <span class=n>AM</span> <span class=n>UTC</span>
</span></span><span class=line><span class=cl><span class=n>Build</span> <span class=n>Host</span>  <span class=p>:</span> <span class=n>obs</span><span class=o>-</span><span class=n>worker1639015616</span><span class=o>-</span><span class=n>x86</span><span class=o>-</span><span class=mi>0001</span>
</span></span><span class=line><span class=cl><span class=n>Packager</span>    <span class=p>:</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>openeuler</span><span class=o>.</span><span class=n>org</span>
</span></span><span class=line><span class=cl><span class=n>Vendor</span>      <span class=p>:</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>openeuler</span><span class=o>.</span><span class=n>org</span>
</span></span><span class=line><span class=cl><span class=n>URL</span>         <span class=p>:</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>www</span><span class=o>.</span><span class=n>python</span><span class=o>.</span><span class=n>org</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=n>Summary</span>     <span class=p>:</span> <span class=n>Interpreter</span> <span class=n>of</span> <span class=n>the</span> <span class=n>Python3</span> <span class=n>programming</span> <span class=n>language</span>
</span></span><span class=line><span class=cl><span class=n>Description</span> <span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>Python</span> <span class=n>combines</span> <span class=n>remarkable</span> <span class=n>power</span> <span class=n>with</span> <span class=n>very</span> <span class=n>clear</span> <span class=n>syntax</span><span class=o>.</span> <span class=n>It</span> <span class=n>has</span> <span class=n>modules</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=n>classes</span><span class=p>,</span> <span class=n>exceptions</span><span class=p>,</span> <span class=n>very</span> <span class=n>high</span> <span class=n>level</span> <span class=n>dynamic</span> <span class=n>data</span> <span class=n>types</span><span class=p>,</span> <span class=ow>and</span> <span class=n>dynamic</span>
</span></span><span class=line><span class=cl><span class=n>typing</span><span class=o>.</span> <span class=n>There</span> <span class=n>are</span> <span class=n>interfaces</span> <span class=n>to</span> <span class=n>many</span> <span class=n>system</span> <span class=n>calls</span> <span class=ow>and</span> <span class=n>libraries</span><span class=p>,</span> <span class=n>as</span> <span class=n>well</span>
</span></span><span class=line><span class=cl><span class=n>as</span> <span class=n>to</span> <span class=n>various</span> <span class=n>windowing</span> <span class=n>systems</span><span class=o>.</span> <span class=n>New</span> <span class=n>built</span><span class=o>-</span><span class=ow>in</span> <span class=n>modules</span> <span class=n>are</span> <span class=n>easily</span> <span class=n>written</span>
</span></span><span class=line><span class=cl><span class=ow>in</span> <span class=n>C</span> <span class=ow>or</span> <span class=n>C</span><span class=o>++</span> <span class=p>(</span><span class=ow>or</span> <span class=n>other</span> <span class=n>languages</span><span class=p>,</span> <span class=n>depending</span> <span class=n>on</span> <span class=n>the</span> <span class=n>chosen</span> <span class=n>implementation</span><span class=p>)</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>Python</span> <span class=n>is</span> <span class=n>also</span> <span class=n>usable</span> <span class=n>as</span> <span class=n>an</span> <span class=n>extension</span> <span class=n>language</span> <span class=k>for</span> <span class=n>applications</span> <span class=n>written</span>
</span></span><span class=line><span class=cl><span class=ow>in</span> <span class=n>other</span> <span class=n>languages</span> <span class=n>that</span> <span class=n>need</span> <span class=n>easy</span><span class=o>-</span><span class=n>to</span><span class=o>-</span><span class=n>use</span> <span class=n>scripting</span> <span class=ow>or</span> <span class=n>automation</span> <span class=n>interfaces</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>This</span> <span class=n>package</span> <span class=n>Provides</span> <span class=n>python</span> <span class=n>version</span> <span class=mf>3.</span></span></span></code></pre></td></tr></table></div></div><p><strong>操作6. 查看未安装的RPM包所有文件</strong></p><p>查看未安装的RPM包的文件列表，可以在rpm命令中使用 <strong>-qlp</strong> 选项。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># rpm -qlp pkgship-2.2.0-10.oe2203sp2.noarch.rpm
</span></span><span class=line><span class=cl>/etc/ima/digest_lists.tlv/0-metadata_list-compact_tlv-pkgship-2.2.0-10.oe2203sp2.noarch
</span></span><span class=line><span class=cl>/etc/ima/digest_lists/0-metadata_list-compact-pkgship-2.2.0-10.oe2203sp2.noarch
</span></span><span class=line><span class=cl>/etc/pkgship/auto_install_pkgship_requires.sh
</span></span><span class=line><span class=cl>/etc/pkgship/conf.yaml
</span></span><span class=line><span class=cl>/etc/pkgship/package.ini
</span></span><span class=line><span class=cl>......</span></span></code></pre></td></tr></table></div></div><p><strong>操作7. 查看未安装的RPM包依赖项</strong></p><p>查看未安装的RPM包编译的依赖包列表，可以在rpm命令中使用 <strong>-qRp</strong> 选项。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># rpm -qRp pkgship-2.2.0-10.oe2203sp2.noarch.rpm
</span></span><span class=line><span class=cl>/bin/bash
</span></span><span class=line><span class=cl>/bin/sh
</span></span><span class=line><span class=cl>/usr/bin/python3
</span></span><span class=line><span class=cl>config(pkgship) = 2.2.0-10.oe2203sp2
</span></span><span class=line><span class=cl>python3
</span></span><span class=line><span class=cl>python3-Flask-Limiter
</span></span><span class=line><span class=cl>......</span></span></code></pre></td></tr></table></div></div><p><strong>操作8. 验证所有已安装的RPM包</strong></p><p>验证已安装的RPM包时，将包中安装的文件信息与<strong>rpm数据库</strong>中存储的包元数据中获取的文件的信息进行比较，可以通过在rpm命令中使用 <strong>-Va</strong> 选项。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># rpm -Va</span>
</span></span><span class=line><span class=cl><span class=n>S</span><span class=o>.</span><span class=mf>5.</span><span class=o>...</span><span class=n>T</span><span class=o>.</span>  <span class=n>c</span> <span class=o>/</span><span class=n>root</span><span class=o>/.</span><span class=n>bashrc</span>
</span></span><span class=line><span class=cl><span class=o>.......</span><span class=n>T</span><span class=o>.</span>  <span class=n>c</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>yum</span><span class=o>.</span><span class=n>repos</span><span class=o>.</span><span class=n>d</span><span class=o>/</span><span class=n>openEuler</span><span class=o>.</span><span class=n>repo</span>
</span></span><span class=line><span class=cl><span class=n>S</span><span class=o>.</span><span class=mf>5.</span><span class=o>...</span><span class=n>T</span><span class=o>.</span>  <span class=n>c</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>issue</span>
</span></span><span class=line><span class=cl><span class=n>S</span><span class=o>.</span><span class=mf>5.</span><span class=o>...</span><span class=n>T</span><span class=o>.</span>  <span class=n>c</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>issue</span><span class=o>.</span><span class=n>net</span>
</span></span><span class=line><span class=cl><span class=n>S</span><span class=o>.</span><span class=mf>5.</span><span class=o>...</span><span class=n>T</span><span class=o>.</span>  <span class=n>c</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>csh</span><span class=o>.</span><span class=n>login</span>
</span></span><span class=line><span class=cl><span class=n>S</span><span class=o>.</span><span class=mf>5.</span><span class=o>...</span><span class=n>T</span><span class=o>.</span>  <span class=n>c</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>profile</span>
</span></span><span class=line><span class=cl><span class=o>.</span><span class=n>M</span><span class=o>....</span><span class=n>G</span><span class=o>..</span>  <span class=n>g</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=nb>log</span><span class=o>/</span><span class=n>lastlog</span>
</span></span><span class=line><span class=cl><span class=o>.</span><span class=n>M</span><span class=o>.......</span>  <span class=n>c</span> <span class=o>/</span><span class=n>boot</span><span class=o>/</span><span class=n>grub2</span><span class=o>/</span><span class=n>grubenv</span>
</span></span><span class=line><span class=cl><span class=o>......</span></span></span></code></pre></td></tr></table></div></div><p>rpm -Va命令相关输出字段及其含义:</p><table><thead><tr><th style=text-align:left>字段</th><th style=text-align:left>含义</th></tr></thead><tbody><tr><td style=text-align:left>S</td><td style=text-align:left>文件长度发生变化。</td></tr><tr><td style=text-align:left>M</td><td style=text-align:left>文件的访问权限或文件类型发生变化。</td></tr><tr><td style=text-align:left>5</td><td style=text-align:left>MD5校验和发生变化。</td></tr><tr><td style=text-align:left>D</td><td style=text-align:left>设备节点的属性发生变化。</td></tr><tr><td style=text-align:left>L</td><td style=text-align:left>文件的符号链接发生变化。</td></tr><tr><td style=text-align:left>U</td><td style=text-align:left>文件/子目录/ 设备节点的owner发生变化。</td></tr><tr><td style=text-align:left>G</td><td style=text-align:left>文件/子目录/ 设备节点的group发生变化。</td></tr><tr><td style=text-align:left>T</td><td style=text-align:left>文件最后一次的修改时间发生变化。</td></tr></tbody></table><p><strong>操作9. 查看特定文件的RPM包</strong></p><p>在Linux上找到一个提供特定二进制文件的RPM包，可以在rpm命令中使用 <strong>-qf</strong> 选项。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># rpm -qf /usr/share/doc/pkgship
</span></span><span class=line><span class=cl>pkgship-2.2.0-10.oe2203sp2.noarch.rpm</span></span></code></pre></td></tr></table></div></div><p><strong>操作10. 查看已安装RPM包中的文件</strong></p><p>查看特定RPM包的安装文件列表，可以在rpm命令中使用 <strong>-ql</strong> 选项。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># rpm -ql dnf</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>bash_completion</span><span class=o>.</span><span class=n>d</span><span class=o>/</span><span class=n>dnf</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>ima</span><span class=o>/</span><span class=n>digest_lists</span><span class=o>.</span><span class=n>tlv</span><span class=o>/</span><span class=mi>0</span><span class=o>-</span><span class=n>metadata_list</span><span class=o>-</span><span class=n>compact_tlv</span><span class=o>-</span><span class=n>dnf</span><span class=o>-</span><span class=mf>4.14</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=mf>14.</span><span class=n>oe2203sp2</span><span class=o>.</span><span class=n>noarch</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>ima</span><span class=o>/</span><span class=n>digest_lists</span><span class=o>/</span><span class=mi>0</span><span class=o>-</span><span class=n>metadata_list</span><span class=o>-</span><span class=n>compact</span><span class=o>-</span><span class=n>dnf</span><span class=o>-</span><span class=n>dnf</span><span class=o>-</span><span class=mf>4.14</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=mf>14.</span><span class=n>oe2203sp2</span><span class=o>.</span><span class=n>noarch</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>dnf</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>systemd</span><span class=o>/</span><span class=n>system</span><span class=o>/</span><span class=n>dnf</span><span class=o>-</span><span class=n>makecache</span><span class=o>.</span><span class=n>service</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>systemd</span><span class=o>/</span><span class=n>system</span><span class=o>/</span><span class=n>dnf</span><span class=o>-</span><span class=n>makecache</span><span class=o>.</span><span class=n>timer</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>doc</span><span class=o>/</span><span class=n>dnf</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>doc</span><span class=o>/</span><span class=n>dnf</span><span class=o>/</span><span class=n>AUTHORS</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>doc</span><span class=o>/</span><span class=n>dnf</span><span class=o>/</span><span class=n>README</span><span class=o>.</span><span class=n>rst</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>licenses</span><span class=o>/</span><span class=n>dnf</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>licenses</span><span class=o>/</span><span class=n>dnf</span><span class=o>/</span><span class=n>COPYING</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>licenses</span><span class=o>/</span><span class=n>dnf</span><span class=o>/</span><span class=n>PACKAGE</span><span class=o>-</span><span class=n>LICENSING</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>cache</span><span class=o>/</span><span class=n>dnf</span></span></span></code></pre></td></tr></table></div></div><p><strong>操作11. 查看最近安装的RPM包</strong></p><p>Linux是一个多用户操作系统，在使用过程中，其他用户可能已经安装了部分软件包。如需在系统中找到最近安装的包，可以在rpm命令中使用 <strong>-qa</strong> <strong>&ndash;last</strong> 选项。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># rpm -qa --last
</span></span><span class=line><span class=cl>ntp-4.2.8p15-11.oe2203sp2.x86_64
</span></span><span class=line><span class=cl>ntpstat-0.6-4.oe2203sp2.noarch
</span></span><span class=line><span class=cl>ntp-help-4.2.8p15-11.oe2203sp2.noarch</span></span></code></pre></td></tr></table></div></div><p><strong>操作12. 只查看已安装RPM包的文档</strong></p><p>可以从Linux Man页面获得任何命令的帮助（<strong>/usr/share/doc/Package_Name-Version_Number/docs</strong>* 文档存放路径），查看安装的RPM包相关联的文档列表，请在rpm命令中使用 <strong>-qdf</strong> 选项，并输入<strong>二进制文件路径</strong>。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># rpm -qdf /usr/bin/grep
</span></span><span class=line><span class=cl>/usr/share/doc/grep/NEWS
</span></span><span class=line><span class=cl>/usr/share/doc/grep/README
</span></span><span class=line><span class=cl>/usr/share/doc/grep/THANKS
</span></span><span class=line><span class=cl>/usr/share/doc/grep/TODO
</span></span><span class=line><span class=cl>/usr/share/info/grep.info.gz
</span></span><span class=line><span class=cl>/usr/share/man/man1/egrep.1.gz
</span></span><span class=line><span class=cl>/usr/share/man/man1/fgrep.1.gz
</span></span><span class=line><span class=cl>/usr/share/man/man1/grep.1.gz</span></span></code></pre></td></tr></table></div></div><p><strong>操作13. 升级已安装的RPM包</strong></p><p>通过使用 <strong>-Uvh</strong> 选项和rpm命令，可以轻松地将已经安装的rpm包升级到最新版本。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># rpm -Uvh pkgship-2.2.0-10.oe2203sp2.noarch.rpm
</span></span><span class=line><span class=cl>Preparing...        ################################# [100%]</span></span></code></pre></td></tr></table></div></div><p><strong>注意</strong>：升级安装的RPM包时，会删除旧RPM包，安装新RPM包。</p><p><strong>操作14. 移除已安装的RPM包</strong></p><p>删除安装在系统上的rpm包，请在rpm命令中使用 <strong>-ev</strong> 或 <strong>-e</strong> 选项。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>rpm -ev pkgship</span></span></code></pre></td></tr></table></div></div><p><strong>操作15. 重建损坏的RPM数据库</strong></p><p>在尝试使用<strong>yum update</strong>命令更新系统时，可能会收到一条错误消息（<strong>RPM数据库已损坏</strong>），如果收到该信息，请在RPM命令中使用 <strong>&ndash;rebuilddb</strong> 选项。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>rm</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>rpm</span><span class=o>/</span><span class=n>__db</span><span class=o>*</span>
</span></span><span class=line><span class=cl><span class=n>rpm</span> <span class=o>--</span><span class=n>rebuilddb</span></span></span></code></pre></td></tr></table></div></div><p><strong>操作16. 检查特定包的漏洞是否已修复</strong></p><p>可以通过在rpm命令中使用 <strong>&ndash;changelog</strong> 选项并输入相应的<strong>CVE</strong>来实现。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>rpm -q --changelog python-2.6.6 | grep -i &#34;CVE-2019-9636&#34;</span></span></code></pre></td></tr></table></div></div><p><strong>操作17. 导入RPM GPG密钥</strong></p><p>默认情况下，当向Linux系统添加新的存储库时，GPG密钥将自动导入。同时，也可在RPM命令中添加**&ndash;import** 手动导入RPM GPG密钥，用于从存储库下载时检查包的完整性。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-OpenEuler-24.03-LTS-SP1</span></span></code></pre></td></tr></table></div></div><ol><li>dnf命令</li></ol><p>dnf命令及其相关概述</p><table><thead><tr><th style=text-align:left>命令</th><th style=text-align:left>概述</th></tr></thead><tbody><tr><td style=text-align:left>repolist</td><td style=text-align:left>显示已配置的软件repo源。</td></tr><tr><td style=text-align:left>install</td><td style=text-align:left>Linux上安装单个或多个软件包。</td></tr><tr><td style=text-align:left>upgrade</td><td style=text-align:left>升级Linux上的一个或多个软件包。</td></tr><tr><td style=text-align:left>list</td><td style=text-align:left>列出一个或一组软件包。</td></tr><tr><td style=text-align:left>info</td><td style=text-align:left>显示关于软件包或软件包组的详细信息。</td></tr><tr><td style=text-align:left>updateinfo</td><td style=text-align:left>显示关于包的公告信息。</td></tr><tr><td style=text-align:left>search</td><td style=text-align:left>在软件包详细信息中搜索指定字符串。</td></tr><tr><td style=text-align:left>check-update</td><td style=text-align:left>检查是否有软件包升级。</td></tr><tr><td style=text-align:left>remove</td><td style=text-align:left>从系统中移除一个或多个软件包。</td></tr><tr><td style=text-align:left>reinstall</td><td style=text-align:left>重装一个包。</td></tr><tr><td style=text-align:left>downgrade</td><td style=text-align:left>降级软件包。</td></tr><tr><td style=text-align:left>autoremove</td><td style=text-align:left>删除所有原先因为依赖关系安装的不需要的软件包。</td></tr><tr><td style=text-align:left>distro-sync</td><td style=text-align:left>同步已经安装的软件包到最新可用版本。</td></tr><tr><td style=text-align:left>makecache</td><td style=text-align:left>创建元数据缓存。</td></tr><tr><td style=text-align:left>repository-package</td><td style=text-align:left>对指定仓库中的所有软件包运行命令。</td></tr><tr><td style=text-align:left>provides</td><td style=text-align:left>查找提供指定内容的软件包。</td></tr><tr><td style=text-align:left>group</td><td style=text-align:left>显示或使用组信息。</td></tr><tr><td style=text-align:left>history</td><td style=text-align:left>显示或使用事务历史。</td></tr><tr><td style=text-align:left>clean</td><td style=text-align:left>删除已缓存的数据。</td></tr></tbody></table><p><strong>操作1. 已配置的软件repo</strong></p><p>显示已配置的软件仓库，默认添加 <strong>&ndash;enabled</strong> 选项（显示启用的仓库）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># dnf repolist --enabled
</span></span><span class=line><span class=cl>repo id                                                                   repo name
</span></span><span class=line><span class=cl>EPOL                                                                      EPOL
</span></span><span class=line><span class=cl>OS                                                                        OS
</span></span><span class=line><span class=cl>debuginfo                                                                 debuginfo
</span></span><span class=line><span class=cl>everything                                                                everything
</span></span><span class=line><span class=cl>pkgship_elasticsearch                                                     Elasticsearch repositor
</span></span><span class=line><span class=cl>source                                                                    source
</span></span><span class=line><span class=cl>update                                                                    update</span></span></code></pre></td></tr></table></div></div><ul><li><strong>&ndash;all</strong>: 显示所有的软件仓库</li><li><strong>&ndash;disabled</strong>: 显示被禁用的软件仓库</li><li><strong>&ndash;enabled</strong>: 显示已经启用的仓库（默认）</li></ul><p><strong>操作2. 安装单个或多个软件包</strong></p><p>通过<strong>install</strong> 命令可以安装RPM包。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># dnf install 软件包</span></span></code></pre></td></tr></table></div></div><p>安装软件包的过程中可能会存在<strong>冲突</strong>的包或<strong>无法安装</strong>的包，可以在命令中增加 <strong>&ndash;allowerasing</strong> 来替换冲突的软件包或 <strong>&ndash;skip-broken</strong> 来跳过无法安装的软件包。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># dnf install 软件包 [软件包 ...] --allowerasing --skip-broken</span></span></code></pre></td></tr></table></div></div><p>当使用dnf安装软件包时，通过添加 <strong>&ndash;installroot</strong> 设置软件包安装的根目录。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># dnf install 软件包 --installroot 软件包安装的根目录</span></span></code></pre></td></tr></table></div></div><p>需要临时指定特定的repo源安装时，可以添加 <strong>&ndash;setopt=reposdir=</strong> 选项来指定repo源的加载目录。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># dnf install 软件包 --setopt=reposdir=repo源的加载目录</span></span></code></pre></td></tr></table></div></div><p>在安装选项时，不需要交互式确认时，可以通过添加 <strong>-y</strong> 或**&ndash;assumeyes** 使需要安装的软件包全部自动应答为<strong>是</strong>。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># dnf install 软件包 -y</span></span></code></pre></td></tr></table></div></div><p>指定特定的repo源安装rpm包时，可以通过指定 <strong>&ndash;repo</strong> 或 <strong>&ndash;enablerepo</strong> 选项。为了达到相同的效果，也可以通过使用 <strong>&ndash;disablerepo</strong> 选项来禁用匹配的repo源，此处推荐您使用&ndash;repo选项来安装RPM包。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># dnf install 软件包 --repo=repo源</span></span></code></pre></td></tr></table></div></div><p><strong>操作3. 重新安装软件包</strong></p><p>系统上的软件包需要执行重新安装操作时，可以执行 <strong>reinstall</strong> 命令。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># dnf reinstall 软件包</span></span></code></pre></td></tr></table></div></div><p><strong>操作4. 升级一个或多个软件包</strong></p><ul><li>通过<strong>upgrade</strong>或 <strong>update</strong>升级Linux上的一个或多个软件包。</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># dnf upgrade 软件包 [软件包 ...]
</span></span><span class=line><span class=cl># dnf update 软件包 [软件包 ...]</span></span></code></pre></td></tr></table></div></div><p><strong>操作5. 软件包降级</strong></p><p>当软件包版本过高发生兼容性问题时，可以采用降级的方式解决。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># dnf downgrade 软件包</span></span></code></pre></td></tr></table></div></div><p><strong>操作6. 列出一个或一组软件包</strong></p><p>罗列系统中已安装的软件包和配置的repo仓中存在的软件包列表，可以使用 <code>list</code> 命令。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># dnf list</span></span></code></pre></td></tr></table></div></div><p>可以通过添加选项过滤显示的包列表</p><ul><li><strong>&ndash;all</strong>: 显示所有的软件包（默认）</li><li><strong>&ndash;available</strong>: 只显示可用的软件包</li><li><strong>&ndash;installed</strong>: 只显示已安装的软件包</li><li><strong>&ndash;extras</strong>: 只显示额外的软件包</li><li><strong>&ndash;updates</strong>: 只显示需要被升级的软件包</li><li><strong>&ndash;upgrades</strong>: 只显示需要被升级的软件包</li><li><strong>&ndash;autoremove</strong>: 只显示需要被删除的软件包</li><li><strong>&ndash;recent</strong>: 限制最近被改变的软件包</li></ul><p><strong>操作7. 查看软件包详细信息</strong></p><p>查看软件包的详细信息时，可以使用<code>info</code> 命令。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># dnf info 软件包</span></span></code></pre></td></tr></table></div></div><p><strong>操作8. 搜索软件包</strong></p><p>如需在系统中安装软件包，但不确定软件包全称时，可使用<code>search</code>命令查找匹配的包。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># dnf search 软件包</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=操作9-卸载一个或多个软件包><span><strong>操作9. 卸载一个或多个软件包</strong></span>
<a href=#%e6%93%8d%e4%bd%9c9-%e5%8d%b8%e8%bd%bd%e4%b8%80%e4%b8%aa%e6%88%96%e5%a4%9a%e4%b8%aa%e8%bd%af%e4%bb%b6%e5%8c%85 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>删除已过期或重复的软件包时，可使用<code>remove</code>命令移除一个软件包。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># dnf remove 软件包</span></span></code></pre></td></tr></table></div></div><ul><li><strong>&ndash;duplicates</strong>: <strong>删除已安装（重复）的软件包</strong></li><li><strong>&ndash;oldinstallonly</strong>: <strong>移除过期的“仅安装”软件包</strong></li></ul><p><strong>操作10. 自动删除因为依赖关系安装的软件包</strong></p><p>删除因为依赖关系安装的不需要的软件包时，可使用<code>autoremove</code>命令。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># dnf autoremove 软件包</span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=配置ssh><span>配置SSH</span>
<a href=#%e9%85%8d%e7%bd%aessh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><ol><li>SSH服务介绍</li></ol><p><strong>SSH（Secure Shell）**是目前较可靠，专为远程登录会话和其他网络服务**提供安全性保障</strong>的协议。利用SSH协议可以有效防止远程管理过程中的信息泄露问题。透过SSH可以对所有传输的数据进行加密，并防止DNS欺骗和IP欺骗。OpenSSH是SSH协议的免费开源实现。</p><ol><li>配置SSH服务</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 打开并修改/etc/ssh/sshd_config文件
</span></span><span class=line><span class=cl>vi /etc/ssh/sshd_config
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 重新启动SSH服务
</span></span><span class=line><span class=cl>systemctl restart sshd
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 检查SSH服务状态
</span></span><span class=line><span class=cl>systemctl status sshd</span></span></code></pre></td></tr></table></div></div><ol><li>SSH服务配置文件主要选项</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 指定SSH协议版本(Specify SSH Protocol Version)
</span></span><span class=line><span class=cl>Protocol 2
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 允许的用户(Allowed Users)
</span></span><span class=line><span class=cl>AllowUsers xxx
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 被拒绝的用户(Denied Users)
</span></span><span class=line><span class=cl>DenyUser root
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 配置会话超时(Configure Session Timeout)
</span></span><span class=line><span class=cl>ClientAliveInterval 120
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 禁用SSH根登录(Disable SSH Root Login)
</span></span><span class=line><span class=cl>PermitRootLogin no
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 配置或更改SSH端口号(Configure or Change SSH Port Number)
</span></span><span class=line><span class=cl>Port 1234
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 禁用SSH密码身份验证 (Disable SSH Password Authentication)
</span></span><span class=line><span class=cl>PasswordAuthentication no</span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=配置网络-1><span>配置网络</span>
<a href=#%e9%85%8d%e7%bd%ae%e7%bd%91%e7%bb%9c-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h2 class=heading-element id=配置-ip><span>配置 IP</span>
<a href=#%e9%85%8d%e7%bd%ae-ip class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=使用nmcli命令><span>使用nmcli命令</span>
<a href=#%e4%bd%bf%e7%94%a8nmcli%e5%91%bd%e4%bb%a4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>说明：</p><p>使用nmcli命令配置的网络配置可以立即生效且系统重启后配置也不会丢失。</p><h4 class=heading-element id=nmcli介绍><span>nmcli介绍</span>
<a href=#nmcli%e4%bb%8b%e7%bb%8d class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>nmcli是NetworkManager的一个命令行工具，它提供了使用命令行配置由NetworkManager管理网络连接的方法。nmcli命令的基本格式为：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli [OPTIONS] OBJECT { COMMAND | help }</span></span></code></pre></td></tr></table></div></div><p>其中，OBJECT选项可以是general、networking、radio、connection或device等。在日常使用中，最常使用的是-t, &ndash;terse（用于脚本）、-p, &ndash;pretty选项（用于用户）及-h, &ndash;help选项，用户可以使用“nmcli help”获取更多参数及使用信息。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli help</span></span></code></pre></td></tr></table></div></div><p>常用命令使用举例如下：</p><ul><li><p>显示NetworkManager状态：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli general status</span></span></code></pre></td></tr></table></div></div></li><li><p>显示所有连接：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli connection show</span></span></code></pre></td></tr></table></div></div></li><li><p>只显示当前活动连接，如下所示添加-a, &ndash;active：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli connection show --active</span></span></code></pre></td></tr></table></div></div></li><li><p>显示由NetworkManager识别到的设备及其状态：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli device status</span></span></code></pre></td></tr></table></div></div></li><li><p>使用nmcli工具启动和停止网络接口，在root权限下执行如下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli connection up id enp3s0
</span></span><span class=line><span class=cl># nmcli device disconnect enp3s0</span></span></code></pre></td></tr></table></div></div></li></ul><h4 class=heading-element id=设备管理><span>设备管理</span>
<a href=#%e8%ae%be%e5%a4%87%e7%ae%a1%e7%90%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h5 class=heading-element id=连接到设备><span>连接到设备</span>
<a href=#%e8%bf%9e%e6%8e%a5%e5%88%b0%e8%ae%be%e5%a4%87 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>使用如下命令，NetworkManager将连接到对应网络设备，尝试找到合适的连接配置，并激活配置。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli device connect &#34;$IFNAME&#34;</span></span></code></pre></td></tr></table></div></div><blockquote><p>如果不存在相应的配置连接，NetworkManager将创建并激活具有默认设置的新配置文件。</p></blockquote><h5 class=heading-element id=断开设备连接><span>断开设备连接</span>
<a href=#%e6%96%ad%e5%bc%80%e8%ae%be%e5%a4%87%e8%bf%9e%e6%8e%a5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>使用如下命令，NetworkManager将断开设备连接，并防止设备自动激活。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli device disconnect &#34;$IFNAME&#34;</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=设置网络连接><span>设置网络连接</span>
<a href=#%e8%ae%be%e7%bd%ae%e7%bd%91%e7%bb%9c%e8%bf%9e%e6%8e%a5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>列出目前可用的网络连接：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli con show
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME    UUID                                  TYPE      DEVICE
</span></span><span class=line><span class=cl>enp4s0  5afce939-400e-42fd-91ee-55ff5b65deab  ethernet  enp4s0
</span></span><span class=line><span class=cl>enp3s0  c88d7b69-f529-35ca-81ab-aa729ac542fd  ethernet  enp3s0
</span></span><span class=line><span class=cl>virbr0  ba552da6-f014-49e3-91fa-ec9c388864fa  bridge    virbr0</span></span></code></pre></td></tr></table></div></div><p>说明：</p><p>输出结果中的NAME字段代表连接ID（名称）。</p><p>添加一个网络连接会生成相应的配置文件，并与相应的设备关联。检查可用的设备，方法如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli dev status
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>DEVICE      TYPE      STATE      CONNECTION
</span></span><span class=line><span class=cl>enp3s0      ethernet  connected  enp3s0
</span></span><span class=line><span class=cl>enp4s0      ethernet  connected  enp4s0
</span></span><span class=line><span class=cl>virbr0      bridge    connected  virbr0
</span></span><span class=line><span class=cl>lo          loopback  unmanaged  --
</span></span><span class=line><span class=cl>virbr0-nic  tun       unmanaged  --</span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=配置动态ip连接><span>配置动态IP连接</span>
<a href=#%e9%85%8d%e7%bd%ae%e5%8a%a8%e6%80%81ip%e8%bf%9e%e6%8e%a5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><h6 class=heading-element id=配置ip><span>配置IP</span>
<a href=#%e9%85%8d%e7%bd%aeip class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h6><p>要使用 DHCP 分配网络时，可以使用动态IP配置添加网络配置文件，命令格式如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>nmcli connection add type ethernet con-name connection-name ifname interface-name</span></span></code></pre></td></tr></table></div></div><p>例如创建名为net-test的动态连接配置文件，在root权限下使用以下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli connection add type ethernet con-name net-test ifname enp3s0
</span></span><span class=line><span class=cl>Connection &#39;net-test&#39; (a771baa0-5064-4296-ac40-5dc8973967ab) successfully added.</span></span></code></pre></td></tr></table></div></div><p>NetworkManager 会将参数 connection.autoconnect 设定为 yes，并将设置保存到 “/etc/sysconfig/network-scripts/ifcfg-net-test”文件中，在该文件中会将 ONBOOT 设置为 yes。</p><h6 class=heading-element id=激活连接并检查状态><span>激活连接并检查状态</span>
<a href=#%e6%bf%80%e6%b4%bb%e8%bf%9e%e6%8e%a5%e5%b9%b6%e6%a3%80%e6%9f%a5%e7%8a%b6%e6%80%81 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h6><p>在root权限下使用以下命令激活网络连接：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli con up net-test 
</span></span><span class=line><span class=cl>Connection successfully activated (D-Bus active path:/org/freedesktop/NetworkManager/ActiveConnection/5)</span></span></code></pre></td></tr></table></div></div><p>检查这些设备及连接的状态，使用以下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli device status
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>DEVICE      TYPE      STATE      CONNECTION
</span></span><span class=line><span class=cl>enp4s0      ethernet  connected  enp4s0
</span></span><span class=line><span class=cl>enp3s0      ethernet  connected  net-test
</span></span><span class=line><span class=cl>virbr0      bridge    connected  virbr0
</span></span><span class=line><span class=cl>lo          loopback  unmanaged  --
</span></span><span class=line><span class=cl>virbr0-nic  tun       unmanaged  --</span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=配置静态ip连接><span>配置静态IP连接</span>
<a href=#%e9%85%8d%e7%bd%ae%e9%9d%99%e6%80%81ip%e8%bf%9e%e6%8e%a5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><h6 class=heading-element id=配置ip-1><span>配置IP</span>
<a href=#%e9%85%8d%e7%bd%aeip-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h6><p>添加静态 IPv4 配置的网络连接，可使用以下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>nmcli connection add type ethernet con-name connection-name ifname interface-name ip4 address gw4 address</span></span></code></pre></td></tr></table></div></div><p>说明：</p><p>如果要添加 IPv6 地址和网关信息，使用 ip6 和 gw6 选项。</p><p>例如创建名为 net-static的静态连接配置文件，在root权限下使用以下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli con add type ethernet con-name net-static ifname enp3s0 ip4 192.168.0.10/24 gw4 192.168.0.254</span></span></code></pre></td></tr></table></div></div><p>还可为该设备同时指定 IPv6 地址和网关，示例如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli con add type ethernet con-name test-lab ifname enp3s0 ip4 192.168.0.10/24 gw4 192.168.0.254 ip6 abbe::**** gw6 2001:***::*
</span></span><span class=line><span class=cl>Connection &#39;net-static&#39; (63aa2036-8665-f54d-9a92-c3035bad03f7) successfully added.</span></span></code></pre></td></tr></table></div></div><p>NetworkManager 会将其内部参数 ipv4.method 设定为 manual，将 connection.autoconnect 设定为yes，并将设置写入 /etc/sysconfig/network-scripts/ifcfg-net-static 文件，其中会将对应 BOOTPROTO 设定为 none，将 ONBOOT 设定为 yes。</p><p>设定两个 IPv4 DNS 服务器地址，在root权限下使用以下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli con mod net-static ipv4.dns &#34;*.*.*.* *.*.*.*&#34;</span></span></code></pre></td></tr></table></div></div><p>设置两个 IPv6 DNS 服务器地址，在root权限下使用以下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli con mod net-static ipv6.dns &#34;2001:4860:4860::**** 2001:4860:4860::****&#34;</span></span></code></pre></td></tr></table></div></div><h6 class=heading-element id=激活连接并检查状态-1><span>激活连接并检查状态</span>
<a href=#%e6%bf%80%e6%b4%bb%e8%bf%9e%e6%8e%a5%e5%b9%b6%e6%a3%80%e6%9f%a5%e7%8a%b6%e6%80%81-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h6><p>激活新的网络连接，在root权限下使用以下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli con up net-static ifname enp3s0
</span></span><span class=line><span class=cl>Connection successfully activated (D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/6)</span></span></code></pre></td></tr></table></div></div><p>检查这些设备及连接的状态，使用以下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli device status
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>DEVICE      TYPE      STATE      CONNECTION
</span></span><span class=line><span class=cl>enp4s0      ethernet  connected  enp4s0
</span></span><span class=line><span class=cl>enp3s0      ethernet  connected  net-static
</span></span><span class=line><span class=cl>virbr0      bridge    connected  virbr0
</span></span><span class=line><span class=cl>lo          loopback  unmanaged  --
</span></span><span class=line><span class=cl>virbr0-nic  tun       unmanaged  --</span></span></code></pre></td></tr></table></div></div><p>查看配置的连接详情，使用以下命令（使用 -p，&ndash;pretty 选项在输出结果中添加标题和分段）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli -p con show net-static 
</span></span><span class=line><span class=cl>===============================================================================
</span></span><span class=line><span class=cl>Connection profile details (net-static )
</span></span><span class=line><span class=cl>===============================================================================
</span></span><span class=line><span class=cl>connection.id:                          net-static
</span></span><span class=line><span class=cl>connection.uuid:                        b9f18801-6084-4aee-af28-c8f0598ff5e1
</span></span><span class=line><span class=cl>connection.stable-id:                   --
</span></span><span class=line><span class=cl>connection.type:                        802-3-ethernet
</span></span><span class=line><span class=cl>connection.interface-name:              enp3s0
</span></span><span class=line><span class=cl>connection.autoconnect:                 yes
</span></span><span class=line><span class=cl>connection.autoconnect-priority:        0
</span></span><span class=line><span class=cl>connection.autoconnect-retries:         -1 (default)
</span></span><span class=line><span class=cl>connection.multi-connect:               0 (default)
</span></span><span class=line><span class=cl>connection.auth-retries:                -1
</span></span><span class=line><span class=cl>connection.timestamp:                   1578988781
</span></span><span class=line><span class=cl>connection.read-only:                   no
</span></span><span class=line><span class=cl>connection.permissions:                 --
</span></span><span class=line><span class=cl>connection.zone:                        --
</span></span><span class=line><span class=cl>connection.master:                      --
</span></span><span class=line><span class=cl>connection.slave-type:                  --
</span></span><span class=line><span class=cl>connection.autoconnect-slaves:          -1 (default)
</span></span><span class=line><span class=cl>connection.secondaries:                 --
</span></span><span class=line><span class=cl>connection.gateway-ping-timeout:        0
</span></span><span class=line><span class=cl>connection.metered:                     unknown
</span></span><span class=line><span class=cl>connection.lldp:                        default
</span></span><span class=line><span class=cl>connection.mdns:                        -1 (default)
</span></span><span class=line><span class=cl>connection.llmnr:                       -1 (default)</span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=添加-wi-fi-连接><span>添加 Wi-Fi 连接</span>
<a href=#%e6%b7%bb%e5%8a%a0-wi-fi-%e8%bf%9e%e6%8e%a5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>有两种方式添加Wi-Fi 连接。</p><h6 class=heading-element id=方法1-通过网络接口连接wifi><span>方法1. 通过网络接口连接wifi</span>
<a href=#%e6%96%b9%e6%b3%951-%e9%80%9a%e8%bf%87%e7%bd%91%e7%bb%9c%e6%8e%a5%e5%8f%a3%e8%bf%9e%e6%8e%a5wifi class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h6><p>连接到由SSID或BSSID指定的wifi网络。命令如下，该命令找到匹配的连接或创建一个连接，然后在设备上激活它。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>nmcli device wifi connect &#34;$SSID&#34; password &#34;$PASSWORD&#34; ifname &#34;$IFNAME&#34;  
</span></span><span class=line><span class=cl>nmcli --ask device wifi connect &#34;$SSID&#34;</span></span></code></pre></td></tr></table></div></div><h6 class=heading-element id=方法2-通过配置文件连接wi-fi><span>方法2. 通过配置文件连接Wi-Fi</span>
<a href=#%e6%96%b9%e6%b3%952-%e9%80%9a%e8%bf%87%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6%e8%bf%9e%e6%8e%a5wi-fi class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h6><p>1，使用以下命令查看可用 Wi-Fi 访问点：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli dev wifi list</span></span></code></pre></td></tr></table></div></div><p>2，使用以下命令生成使用的静态 IP 配置，但允许自动 DNS 地址分配的 Wi-Fi 连接：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli con add con-name Wifi ifname wlan0 type wifi ssid MyWifi ip4 192.168.100.101/24 gw4 192.168.100.1</span></span></code></pre></td></tr></table></div></div><p>3，请使用以下命令设定 WPA2 密码，例如 “answer”：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli con modify Wifi wifi-sec.key-mgmt wpa-psk
</span></span><span class=line><span class=cl># nmcli con modify Wifi wifi-sec.psk answer</span></span></code></pre></td></tr></table></div></div><p>4，使用以下命令更改 Wi-Fi 状态：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli radio wifi [ on | off ]</span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=更改属性><span>更改属性 <a href=https://docs.openeuler.openatom.cn/zh/docs/24.03_LTS_SP1/server/network/network_config/network_configuration.html#user-content-%e6%9b%b4%e6%94%b9%e5%b1%9e%e6%80%a7 target=_blank rel="external nofollow noopener noreferrer"></a></span><a href=#%e6%9b%b4%e6%94%b9%e5%b1%9e%e6%80%a7 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>请使用以下命令检查具体属性，比如 mtu：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli connection show id &#39;Wifi &#39; | grep mtu
</span></span><span class=line><span class=cl>802-11-wireless.mtu: auto</span></span></code></pre></td></tr></table></div></div><p>使用如下命令更改设置的属性：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli connection modify id &#39;Wifi &#39; 802-11-wireless.mtu 1350</span></span></code></pre></td></tr></table></div></div><p>使用如下命令确认更改：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli connection show id &#39;Wifi &#39; | grep mtu
</span></span><span class=line><span class=cl>802-11-wireless.mtu: 1350</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=配置静态路由><span>配置静态路由</span>
<a href=#%e9%85%8d%e7%bd%ae%e9%9d%99%e6%80%81%e8%b7%af%e7%94%b1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><ul><li><p>使用nmcli命令为网络连接配置静态路由，使用命令如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli connection modify enp3s0 +ipv4.routes &#34;192.168.122.0/24 10.10.10.1&#34;</span></span></code></pre></td></tr></table></div></div></li><li><p>使用编辑器配置静态路由，使用如下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli con edit type ethernet con-name enp3s0
</span></span><span class=line><span class=cl>===| nmcli interactive connection editor |===
</span></span><span class=line><span class=cl>Adding a new &#39;802-3-ethernet&#39; connection
</span></span><span class=line><span class=cl>Type &#39;help&#39; or &#39;?&#39; for available commands.
</span></span><span class=line><span class=cl>Type &#39;describe [&lt;setting&gt;.&lt;prop&gt;]&#39; for detailed property description.
</span></span><span class=line><span class=cl>You may edit the following settings: connection, 802-3-ethernet (ethernet), 802-1x, ipv4, ipv6, dcb
</span></span><span class=line><span class=cl>nmcli&gt; set ipv4.routes 192.168.122.0/24 10.10.10.1
</span></span><span class=line><span class=cl>nmcli&gt;
</span></span><span class=line><span class=cl>nmcli&gt; save persistent
</span></span><span class=line><span class=cl>Saving the connection with &#39;autoconnect=yes&#39;. That might result in an immediate activation of the connection.
</span></span><span class=line><span class=cl>Do you still want to save? [yes] yes
</span></span><span class=line><span class=cl>Connection &#39;enp3s0&#39; (1464ddb4-102a-4e79-874a-0a42e15cc3c0) successfully saved.
</span></span><span class=line><span class=cl>nmcli&gt; quit</span></span></code></pre></td></tr></table></div></div></li><li><p>使用如下命令激活连接以生效配置：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli con up enp3s0</span></span></code></pre></td></tr></table></div></div></li></ul><h3 class=heading-element id=使用ip命令><span>使用ip命令</span>
<a href=#%e4%bd%bf%e7%94%a8ip%e5%91%bd%e4%bb%a4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>说明：</p><p>使用ip命令配置的网络配置可以立即生效但系统重启后配置会丢失。</p><h4 class=heading-element id=配置ip地址><span>配置IP地址</span>
<a href=#%e9%85%8d%e7%bd%aeip%e5%9c%b0%e5%9d%80 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>使用ip命令为接口配置地址，命令格式如下，其中 <em>interface-name</em> 为网卡名称。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip addr [ add | del ] address dev interface-name</span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=配置静态地址><span>配置静态地址</span>
<a href=#%e9%85%8d%e7%bd%ae%e9%9d%99%e6%80%81%e5%9c%b0%e5%9d%80 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>在root权限下，配置静态IP地址，使用示例如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip address add 192.168.0.10/24 dev enp3s0</span></span></code></pre></td></tr></table></div></div><p>查看配置结果，在root权限使用如下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip addr show dev enp3s0
</span></span><span class=line><span class=cl>2: enp3s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
</span></span><span class=line><span class=cl>    link/ether 52:54:00:aa:ad:4a brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>    inet 192.168.202.248/16 brd 192.168.255.255 scope global dynamic noprefixroute enp3s0
</span></span><span class=line><span class=cl>       valid_lft 9547sec preferred_lft 9547sec
</span></span><span class=line><span class=cl>    inet 192.168.0.10/24 scope global enp3s0
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>    inet6 fe80::32e8:cc22:9db2:f4d4/64 scope link noprefixroute
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever</span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=配置多个地址><span>配置多个地址</span>
<a href=#%e9%85%8d%e7%bd%ae%e5%a4%9a%e4%b8%aa%e5%9c%b0%e5%9d%80 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>ip 命令支持为同一接口分配多个地址，可在root权限下重复多次使用 ip 命令实现分配多个地址。使用示例如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip address add 192.168.2.223/24 dev enp4s0
</span></span><span class=line><span class=cl># ip address add 192.168.4.223/24 dev enp4s0
</span></span><span class=line><span class=cl># ip addr
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3: enp4s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
</span></span><span class=line><span class=cl>    link/ether 52:54:00:aa:da:e2 brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>    inet 192.168.203.12/16 brd 192.168.255.255 scope global dynamic noprefixroute enp4s0
</span></span><span class=line><span class=cl>       valid_lft 8389sec preferred_lft 8389sec
</span></span><span class=line><span class=cl>    inet 192.168.2.223/24 scope global enp4s0
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>    inet 192.168.4.223/24 scope global enp4s0
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>    inet6 fe80::1eef:5e24:4b67:f07f/64 scope link noprefixroute
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=配置静态路由-1><span>配置静态路由</span>
<a href=#%e9%85%8d%e7%bd%ae%e9%9d%99%e6%80%81%e8%b7%af%e7%94%b1-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>如果需要静态路由，可使用 ip route add 命令在路由表中添加，使用 ip route del 命令删除。最常使用的 ip route 命令格式如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip route [ add | del | change | append | replace ] destination-address</span></span></code></pre></td></tr></table></div></div><p>在root权限下使用 ip route 命令显示当前的 IP 路由表。示例如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip route
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>default via 192.168.0.1 dev enp3s0 proto dhcp metric 100
</span></span><span class=line><span class=cl>default via 192.168.0.1 dev enp4s0 proto dhcp metric 101
</span></span><span class=line><span class=cl>192.168.0.0/16 dev enp3s0 proto kernel scope link src 192.168.202.248 metric 100
</span></span><span class=line><span class=cl>192.168.0.0/16 dev enp4s0 proto kernel scope link src 192.168.203.12 metric 101
</span></span><span class=line><span class=cl>192.168.122.0/24 dev virbr0 proto kernel scope link src 192.168.122.1 linkdown</span></span></code></pre></td></tr></table></div></div><p>在主机地址中添加一个静态路由，在 root 权限下，使用以下命令格式：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip route add 192.168.2.1 via 10.0.0.1 [dev interface-name]</span></span></code></pre></td></tr></table></div></div><p>其中 192.168.2.1 是用点分隔的十进制符号中的 IP 地址，10.0.0.1 是下一个跃点，<em>interface-name</em> 是进入下一个跃点的退出接口。</p><p>要在网络中添加一个静态路由，即代表 IP 地址范围的 IP 地址，请在root权限下运行以下命令格式：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip route add 192.168.2.0/24 via 10.0.0.1 [dev interface-name]</span></span></code></pre></td></tr></table></div></div><p>其中 192.168.2.1 是目标网络的 IP 地址，10.0.0.1 是网络前缀，<em>interface-name</em> 为网卡名称。</p><h3 class=heading-element id=通过ifcfg文件配置网络><span>通过ifcfg文件配置网络</span>
<a href=#%e9%80%9a%e8%bf%87ifcfg%e6%96%87%e4%bb%b6%e9%85%8d%e7%bd%ae%e7%bd%91%e7%bb%9c class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>说明：</p><p>通过ifcfg文件配置的网络配置不会立即生效，修改文件后（以ifcfg-enp3s0为例），需要在root权限下执行<strong>nmcli con reload;nmcli con up enp3s0</strong>命令以重新加载配置文件并激活连接才生效。</p><h4 class=heading-element id=配置静态网络><span>配置静态网络</span>
<a href=#%e9%85%8d%e7%bd%ae%e9%9d%99%e6%80%81%e7%bd%91%e7%bb%9c class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>以enp4s0网络接口进行静态网络设置为例，通过在root权限下修改ifcfg文件实现，在/etc/sysconfig/network-scripts/目录中生成名为ifcfg-enp4s0的文件中，修改参数配置，示例如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>TYPE=Ethernet
</span></span><span class=line><span class=cl>PROXY_METHOD=none
</span></span><span class=line><span class=cl>BROWSER_ONLY=no
</span></span><span class=line><span class=cl>BOOTPROTO=none
</span></span><span class=line><span class=cl>IPADDR=192.168.0.10
</span></span><span class=line><span class=cl>PREFIX=24
</span></span><span class=line><span class=cl>DEFROUTE=yes
</span></span><span class=line><span class=cl>IPV4_FAILURE_FATAL=no
</span></span><span class=line><span class=cl>IPV6INIT=yes
</span></span><span class=line><span class=cl>IPV6_AUTOCONF=yes
</span></span><span class=line><span class=cl>IPV6_DEFROUTE=yes
</span></span><span class=line><span class=cl>IPV6_FAILURE_FATAL=no
</span></span><span class=line><span class=cl>IPV6_ADDR_GEN_MODE=stable-privacy
</span></span><span class=line><span class=cl>NAME=enp4s0static
</span></span><span class=line><span class=cl>UUID=08c3a30e-c5e2-4d7b-831f-26c3cdc29293
</span></span><span class=line><span class=cl>DEVICE=enp4s0
</span></span><span class=line><span class=cl>ONBOOT=yes</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=配置动态网络><span>配置动态网络</span>
<a href=#%e9%85%8d%e7%bd%ae%e5%8a%a8%e6%80%81%e7%bd%91%e7%bb%9c class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>要通过ifcfg文件为em1接口配置动态网络，请按照如下操作在/etc/sysconfig/network-scripts/目录中生成名为 ifcfg-em1 的文件，示例如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>DEVICE=em1
</span></span><span class=line><span class=cl>BOOTPROTO=dhcp
</span></span><span class=line><span class=cl>ONBOOT=yes</span></span></code></pre></td></tr></table></div></div><p>要配置一个向DHCP服务器发送不同的主机名的接口，请在ifcfg文件中新增一行内容，如下所示：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>DHCP_HOSTNAME=hostname</span></span></code></pre></td></tr></table></div></div><p>要配置忽略由DHCP服务器发送的路由，防止网络服务使用从DHCP服务器接收的DNS服务器更新/etc/resolv.conf。请在ifcfg文件中新增一行内容，如下所示：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>PEERDNS=no</span></span></code></pre></td></tr></table></div></div><p>要配置一个接口使用具体DNS服务器，请将参数PEERDNS=no，并在ifcfg文件中添加以下行：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>DNS1=ip-address
</span></span><span class=line><span class=cl>DNS2=ip-address</span></span></code></pre></td></tr></table></div></div><p>其中ip-address是DNS服务器的地址。这样就会让网络服务使用指定的DNS服务器更新/etc/resolv.conf。</p><h4 class=heading-element id=配置默认网关><span>配置默认网关</span>
<a href=#%e9%85%8d%e7%bd%ae%e9%bb%98%e8%ae%a4%e7%bd%91%e5%85%b3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>在确定默认网关时，首先解析 /etc/sysconfig/network 文件，然后解析 ifcfg 文件 ，将最后读取的 GATEWAY 的取值作为路由表中的默认路由。</p><p>在动态网络环境中，使用 NetworkManager 管理主机时，建议设置为由 DHCP 来分配。</p><h3 class=heading-element id=通过-nmtui-工具><span>通过 nmtui 工具</span>
<a href=#%e9%80%9a%e8%bf%87-nmtui-%e5%b7%a5%e5%85%b7 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>nmtui 工具提供了一个交互式的界面，可以用来配置网络连接。要使用 nmtui 工具，以 root 权限执行以下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmtui</span></span></code></pre></td></tr></table></div></div><p>选择 <strong>Edit a connection</strong> 选项，然后选择要编辑的网络连接，按 <strong>Enter</strong> 键，进入编辑界面。</p><p>在交互界面中，可以使用方向键选择要编辑的选项，按 <strong>Tab</strong> 键切换到下一个选项，按 <strong>Enter</strong> 键进入编辑状态，按 <strong>Esc</strong> 键退出编辑状态。可以使用方向键选择 IPV4 CONFIGURATION 或 IPV6 CONFIGURATION 的配置方式，并选择 Show 显示详细信息。</p><h2 class=heading-element id=配置主机名><span>配置主机名</span>
<a href=#%e9%85%8d%e7%bd%ae%e4%b8%bb%e6%9c%ba%e5%90%8d class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=简介><span>简介</span>
<a href=#%e7%ae%80%e4%bb%8b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>hostname有三种类型：static、transient和pretty。</p><ul><li>static：静态主机名，可由用户自行设置，并保存在/etc/hostname 文件中。</li><li>transient：动态主机名，由内核维护，初始是 static 主机名，缺省值为“localhost”。可由DHCP或mDNS在运行时更改。</li><li>pretty：灵活主机名，允许使用自由形式（包括特殊/空白字符）进行设置。静态/动态主机名遵从域名的通用限制。</li></ul><p>说明：</p><p>static和transient主机名只能包含a-z、A-Z、0-9、“-”和“.”，不能在开头或结尾处使用句点，不允许使用两个相连的句点，大小限制为 64 个字符。</p><h3 class=heading-element id=使用hostnamectl配置主机名><span>使用hostnamectl配置主机名</span>
<a href=#%e4%bd%bf%e7%94%a8hostnamectl%e9%85%8d%e7%bd%ae%e4%b8%bb%e6%9c%ba%e5%90%8d class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=查看所有主机名><span>查看所有主机名</span>
<a href=#%e6%9f%a5%e7%9c%8b%e6%89%80%e6%9c%89%e4%b8%bb%e6%9c%ba%e5%90%8d class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>查看当前的主机名，使用如下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># hostnamectl status</span></span></code></pre></td></tr></table></div></div><p>说明：</p><p>如果命令未指定任何选项，则默认使用status选项。</p><h4 class=heading-element id=设定所有主机名><span>设定所有主机名</span>
<a href=#%e8%ae%be%e5%ae%9a%e6%89%80%e6%9c%89%e4%b8%bb%e6%9c%ba%e5%90%8d class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>在root权限下，设定系统中的所有主机名，使用如下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># hostnamectl set-hostname name</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=设定特定主机名><span>设定特定主机名</span>
<a href=#%e8%ae%be%e5%ae%9a%e7%89%b9%e5%ae%9a%e4%b8%bb%e6%9c%ba%e5%90%8d class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>在root权限下，通过不同的参数来设定特定主机名，使用如下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># hostnamectl set-hostname name [option...]</span></span></code></pre></td></tr></table></div></div><p>其中option可以是&ndash;pretty、&ndash;static、&ndash;transient中的一个或多个选项。</p><p>如果&ndash;static或&ndash;transient与&ndash;pretty选项一同使用时，则会将static和transient主机名简化为pretty主机名格式，使用“-”替换空格，并删除特殊字符。</p><p>当设定pretty主机名时，如果主机名中包含空格或单引号，需要使用引号。命令示例如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># hostnamectl set-hostname &#34;Stephen&#39;s notebook&#34; --pretty</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=清除特定主机名><span>清除特定主机名</span>
<a href=#%e6%b8%85%e9%99%a4%e7%89%b9%e5%ae%9a%e4%b8%bb%e6%9c%ba%e5%90%8d class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>要清除特定主机名，并将其还原为默认形式，在root权限下，使用如下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># hostnamectl set-hostname &#34;&#34; [option...]</span></span></code></pre></td></tr></table></div></div><p>其中 "" 是空白字符串，option是&ndash;pretty、&ndash;static和&ndash;transient中的一个或多个选项。</p><h4 class=heading-element id=远程更改主机名><span>远程更改主机名</span>
<a href=#%e8%bf%9c%e7%a8%8b%e6%9b%b4%e6%94%b9%e4%b8%bb%e6%9c%ba%e5%90%8d class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>在远程系统中运行hostnamectl命令时，要使用-H，&ndash;host 选项，在root权限下使用如下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># hostnamectl set-hostname -H [username]@hostname new_hostname</span></span></code></pre></td></tr></table></div></div><p>其中hostname是要配置的远程主机，username为自选项，new_hostname为新主机名。hostnamectl会通过SSH连接到远程系统。</p><h3 class=heading-element id=使用nmcli配置主机名><span>使用nmcli配置主机名</span>
<a href=#%e4%bd%bf%e7%94%a8nmcli%e9%85%8d%e7%bd%ae%e4%b8%bb%e6%9c%ba%e5%90%8d class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>查询static主机名，使用如下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli general hostname</span></span></code></pre></td></tr></table></div></div><p>在root权限下，将static主机名设定为host-server，使用如下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli general hostname host-server</span></span></code></pre></td></tr></table></div></div><p>要让系统hostnamectl感知到static主机名的更改，在root权限下，重启hostnamed服务，使用如下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># systemctl restart systemd-hostnamed</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=通过-nmtui-工具-1><span>通过 nmtui 工具</span>
<a href=#%e9%80%9a%e8%bf%87-nmtui-%e5%b7%a5%e5%85%b7-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>nmtui 提供了一个交互式的界面，可以用来配置网络连接。要使用 nmtui 工具，以 root 权限执行以下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmtui</span></span></code></pre></td></tr></table></div></div><p>选择 <strong>Set system hostname</strong> 选项，输入新的主机名，然后按 <strong>Enter</strong> 键。选择 OK 确认修改。</p><h2 class=heading-element id=配置网络绑定><span>配置网络绑定</span>
<a href=#%e9%85%8d%e7%bd%ae%e7%bd%91%e7%bb%9c%e7%bb%91%e5%ae%9a class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=使用nmcli><span>使用nmcli</span>
<a href=#%e4%bd%bf%e7%94%a8nmcli class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><ul><li><p>创建名为mybond0的绑定，使用示例如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli con add type bond con-name mybond0 ifname mybond0 mode active-backup</span></span></code></pre></td></tr></table></div></div></li><li><p>添加从属接口，使用示例如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli con add type bond-slave ifname enp3s0 master mybond0</span></span></code></pre></td></tr></table></div></div><p>要添加其他从属接口，重复上一个命令，并在命令中使用新的接口，使用示例如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli con add type bond-slave ifname enp4s0 master mybond0
</span></span><span class=line><span class=cl>Connection &#39;bond-slave-enp4s0&#39; (05e56afc-b953-41a9-b3f9-0791eb49f7d3) successfully added.</span></span></code></pre></td></tr></table></div></div></li><li><p>要启动绑定，则必须首先启动从属接口，使用示例如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli con up bond-slave-enp3s0
</span></span><span class=line><span class=cl>Connection successfully activated (D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/14)</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli con up bond-slave-enp4s0
</span></span><span class=line><span class=cl>Connection successfully activated (D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/15)</span></span></code></pre></td></tr></table></div></div><p>现在可以启动绑定，使用示例如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># nmcli con up mybond0
</span></span><span class=line><span class=cl>Connection successfully activated (D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/16)</span></span></code></pre></td></tr></table></div></div></li></ul><h3 class=heading-element id=使用命令行><span>使用命令行</span>
<a href=#%e4%bd%bf%e7%94%a8%e5%91%bd%e4%bb%a4%e8%a1%8c class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=检查是否已安装bonding内核模块><span>检查是否已安装Bonding内核模块</span>
<a href=#%e6%a3%80%e6%9f%a5%e6%98%af%e5%90%a6%e5%b7%b2%e5%ae%89%e8%a3%85bonding%e5%86%85%e6%a0%b8%e6%a8%a1%e5%9d%97 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>在系统中默认已加载相应模块。要载入绑定模块，可在root权限下使用如下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># modprobe --first-time bonding</span></span></code></pre></td></tr></table></div></div><p>显示该模块的信息，可在root权限下使用如下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># modinfo bonding</span></span></code></pre></td></tr></table></div></div><p>更多命令请在root权限下使用modprobe &ndash;help查看。</p><h4 class=heading-element id=创建频道绑定接口><span>创建频道绑定接口</span>
<a href=#%e5%88%9b%e5%bb%ba%e9%a2%91%e9%81%93%e7%bb%91%e5%ae%9a%e6%8e%a5%e5%8f%a3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>要创建绑定接口，可在root权限下通过在 /etc/sysconfig/network-scripts/ 目录中创建名为 ifcfg-bondN 的文件（使用接口号码替换 N，比如 0）。</p><p>根据要绑定接口类型的配置文件来编写相应的内容，比如网络接口。接口配置文件示例如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>DEVICE=bond0
</span></span><span class=line><span class=cl>NAME=bond0
</span></span><span class=line><span class=cl>TYPE=Bond
</span></span><span class=line><span class=cl>BONDING_MASTER=yes
</span></span><span class=line><span class=cl>IPADDR=192.168.1.1
</span></span><span class=line><span class=cl>PREFIX=24
</span></span><span class=line><span class=cl>ONBOOT=yes
</span></span><span class=line><span class=cl>BOOTPROTO=none
</span></span><span class=line><span class=cl>BONDING_OPTS=&#34;bonding parameters separated by spaces&#34;</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=创建从属接口><span>创建从属接口</span>
<a href=#%e5%88%9b%e5%bb%ba%e4%bb%8e%e5%b1%9e%e6%8e%a5%e5%8f%a3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>创建频道绑定接口后，必须在从属接口的配置文件中添加 MASTER 和 SLAVE 指令。</p><p>例如将两个网络接口enp3s0 和 enp4s0 以频道方式绑定，其配置文件示例分别如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>TYPE=Ethernet
</span></span><span class=line><span class=cl>NAME=bond-slave-enp3s0
</span></span><span class=line><span class=cl>UUID=3b7601d1-b373-4fdf-a996-9d267d1cac40
</span></span><span class=line><span class=cl>DEVICE=enp3s0
</span></span><span class=line><span class=cl>ONBOOT=yes
</span></span><span class=line><span class=cl>MASTER=bond0
</span></span><span class=line><span class=cl>SLAVE=yes</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>TYPE=Ethernet
</span></span><span class=line><span class=cl>NAME=bond-slave-enp4s0
</span></span><span class=line><span class=cl>UUID=00f0482c-824f-478f-9479-abf947f01c4a
</span></span><span class=line><span class=cl>DEVICE=enp4s0
</span></span><span class=line><span class=cl>ONBOOT=yes
</span></span><span class=line><span class=cl>MASTER=bond0
</span></span><span class=line><span class=cl>SLAVE=yes</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=激活频道绑定><span>激活频道绑定</span>
<a href=#%e6%bf%80%e6%b4%bb%e9%a2%91%e9%81%93%e7%bb%91%e5%ae%9a class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>要激活绑定，则需要启动所有从属接口。请在root权限下，运行以下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ifup enp3s0
</span></span><span class=line><span class=cl>Connection successfully activated (D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/7)</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ifup enp4s0
</span></span><span class=line><span class=cl>Connection successfully activated (D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/8)</span></span></code></pre></td></tr></table></div></div><p>说明：</p><p>对于已经处于“up”状态的接口，请首先使用“ifdown <em>enp3s0</em> ”命令修改状态为down，其中 <em>enp3s0</em> 为实际网卡名称。</p><p>完成后，启动所有从属接口以便启动绑定（不将其设定为 “down”）。</p><p>要让 NetworkManager 感知到系统所做的修改，在每次修改后，请在root权限下，运行以下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># nmcli con load /etc/sysconfig/network-scripts/ifcfg-device</span></span></span></code></pre></td></tr></table></div></div><p>查看绑定接口的状态，请在root权限下运行以下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip link show
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>2: enp3s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
</span></span><span class=line><span class=cl>    link/ether 52:54:00:aa:ad:4a brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>3: enp4s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
</span></span><span class=line><span class=cl>    link/ether 52:54:00:aa:da:e2 brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>4: virbr0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN mode DEFAULT group default qlen 1000
</span></span><span class=line><span class=cl>    link/ether 86:a1:10:fb:ef:07 brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>5: virbr0-nic: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc fq_codel master virbr0 state DOWN mode DEFAULT group default qlen 1000
</span></span><span class=line><span class=cl>    link/ether 52:54:00:29:35:4c brd ff:ff:ff:ff:ff:ff</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=创建多个绑定><span>创建多个绑定</span>
<a href=#%e5%88%9b%e5%bb%ba%e5%a4%9a%e4%b8%aa%e7%bb%91%e5%ae%9a class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><p>系统会为每个绑定创建一个频道绑定接口，包括 BONDING_OPTS 指令。使用这个配置方法可让多个绑定设备使用不同的配置。请按照以下操作创建多个频道绑定接口：</p><ul><li>创建多个 ifcfg-bondN 文件，文件中包含 BONDING_OPTS 指令，让网络脚本根据需要创建绑定接口。</li><li>创建或编辑要绑定的现有接口配置文件，添加 SLAVE 指令。</li><li>使用 MASTER 指令工具在频道绑定接口中分配要绑定的接口，即从属接口。</li></ul><p>以下是频道绑定接口配置文件示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>DEVICE=bondN
</span></span><span class=line><span class=cl>NAME=bondN
</span></span><span class=line><span class=cl>TYPE=Bond
</span></span><span class=line><span class=cl>BONDING_MASTER=yes
</span></span><span class=line><span class=cl>IPADDR=192.168.1.1
</span></span><span class=line><span class=cl>PREFIX=24
</span></span><span class=line><span class=cl>ONBOOT=yes
</span></span><span class=line><span class=cl>BOOTPROTO=none
</span></span><span class=line><span class=cl>BONDING_OPTS=&#34;bonding parameters separated by spaces&#34;</span></span></code></pre></td></tr></table></div></div><p>在这个示例中，使用绑定接口的号码替换 N。例如要创建两个接口，则需要使用正确的 IP 地址创建两个配置文件 ifcfg-bond0 和 ifcfg-bond1。</p><h3 class=heading-element id=使用-nmtui-工具><span>使用 nmtui 工具</span>
<a href=#%e4%bd%bf%e7%94%a8-nmtui-%e5%b7%a5%e5%85%b7 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>在 nmtui 工具中，选择 <strong>Edit a connection</strong>，然后选择 <strong>Bond</strong>，按照提示输入相关信息，即可创建绑定。</p><p>返回 nmtui 的主菜单，选择 <strong>Activate a connection</strong>，然后选择刚刚创建的绑定，即可激活绑定。</p><h2 class=heading-element id=ipv6使用差异说明vs-ipv4><span>IPv6使用差异说明（vs IPv4）</span>
<a href=#ipv6%e4%bd%bf%e7%94%a8%e5%b7%ae%e5%bc%82%e8%af%b4%e6%98%8evs-ipv4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=配置说明><span>配置说明</span>
<a href=#%e9%85%8d%e7%bd%ae%e8%af%b4%e6%98%8e class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=设置接口设备mtu值><span>设置接口设备MTU值</span>
<a href=#%e8%ae%be%e7%bd%ae%e6%8e%a5%e5%8f%a3%e8%ae%be%e5%a4%87mtu%e5%80%bc class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h5 class=heading-element id=概述><span>概述</span>
<a href=#%e6%a6%82%e8%bf%b0 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>IPv6场景中会发现整个路由路径中的最小mtu的值作为当前链接的PMTU的值，源端根据PMTU的值确定是否进行分片发送，而在整个路径中的其他设备将不再需要进行分片处理，从而可以降低中间路由设备的负载大小。其中IPv6 PMTU设置的最小值为1280。</p><h5 class=heading-element id=设置接口设备的mtu><span>设置接口设备的mtu</span>
<a href=#%e8%ae%be%e7%bd%ae%e6%8e%a5%e5%8f%a3%e8%ae%be%e5%a4%87%e7%9a%84mtu class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>如果在配置了IPv6地址的接口上设置mtu的值小于1280（IPv6 PMTU设置的最小值），则会导致该接口的IPv6地址被删除。并且无法再次添加IPv6地址。所以在IPv6场景中，对接口设备的mtu的配置一定要大于等于1280。 请在root权限下运行如下命令查看具体现象：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip addr show enp3s0
</span></span><span class=line><span class=cl>3: enp3s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
</span></span><span class=line><span class=cl>    link/ether 52:54:00:62:xx:xx brd ff:ff:ff:ff:xx:xx
</span></span><span class=line><span class=cl>    inet 10.41.125.236/16 brd 10.41.255.255 scope global noprefixroute dynamic enp3s0
</span></span><span class=line><span class=cl>       valid_lft 38663sec preferred_lft 38663sec
</span></span><span class=line><span class=cl>    inet6 2001:222::2/64 scope global
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip link set dev enp3s0 mtu 1200
</span></span><span class=line><span class=cl># ip addr show enp3s0
</span></span><span class=line><span class=cl>3: enp3s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1200 qdisc pfifo_fast state UP group default qlen 1000
</span></span><span class=line><span class=cl>    link/ether 52:54:00:62:xx:xx brd ff:ff:ff:ff:xx:xx
</span></span><span class=line><span class=cl>    inet 10.41.125.236/16 brd 10.41.255.255 scope global noprefixroute dynamic enp3s0
</span></span><span class=line><span class=cl>       valid_lft 38642sec preferred_lft 38642sec</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip addr add 2001:222::2/64 dev enp3s0
</span></span><span class=line><span class=cl>RTNETLINK answers: No buffer space available</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip link set dev enp3s0 mtu 1500
</span></span><span class=line><span class=cl># ip addr show enp3s0
</span></span><span class=line><span class=cl>3: enp3s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
</span></span><span class=line><span class=cl>    link/ether 52:54:00:62:xx:xx brd ff:ff:ff:ff:xx:xx
</span></span><span class=line><span class=cl>    inet 10.41.125.236/16 brd 10.41.255.255 scope global noprefixroute dynamic enp3s0
</span></span><span class=line><span class=cl>       valid_lft 38538sec preferred_lft 38538sec</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip addr add 2001:222::2/64 dev enp3s0
</span></span><span class=line><span class=cl># ip addr show enp3s0
</span></span><span class=line><span class=cl>3: enp3s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
</span></span><span class=line><span class=cl>    link/ether 52:54:00:62:xx:xx brd ff:ff:ff:ff:xx:xx
</span></span><span class=line><span class=cl>    inet 10.41.125.236/16 brd 10.41.255.255 scope global noprefixroute dynamic enp3s0
</span></span><span class=line><span class=cl>       valid_lft 38531sec preferred_lft 38531sec
</span></span><span class=line><span class=cl>    inet6 2001:222::2/64 scope global
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=有状态自动配置ipv6地址><span>有状态自动配置IPv6地址</span>
<a href=#%e6%9c%89%e7%8a%b6%e6%80%81%e8%87%aa%e5%8a%a8%e9%85%8d%e7%bd%aeipv6%e5%9c%b0%e5%9d%80 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h5 class=heading-element id=概述-1><span>概述</span>
<a href=#%e6%a6%82%e8%bf%b0-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>IPv6与IPv4都可以在root权限下通过DHCP的方式获得IP地址。IPv6地址有两种配置方式：无状态自动配置和有状态自动配置。</p><ul><li><p>无状态自动配置</p><p>不需要DHCP服务进行管理，设备根据网络RA（路由公告）获得网络前缀，或者link-local地址为固定fe80::。而接口ID则根据ifcfg配置IPV6_ADDR_GEN_MODE的具体设置来进行自动获得：</p><ol><li>IPv6_ADDR_GEN_MODE=&ldquo;stable-privacy&rdquo; 则根据设备及网络环境来确定一个随机接口ID。</li><li>IPv6_ADDR_GEN_MODE=&ldquo;EUI64&rdquo; 则根据设备MAC地址来确定接口ID。</li></ol></li><li><p>有状态自动配置：需要DHCP服务器进行管理分配，服从DHCPv6协议来从DHCPv6服务器端租赁IPv6地址。</p><p>在有状态自动配置IPv6地址时，DHCPv6服务端可以通过客户端设置的vendor class将客户端进行分类，不同类别分配不同地址段的IPv6地址。在IPv4场景中，客户端可以直接用dhclient的-V选项来设置vendor-class-identifier，DHCP服务端在配置文件中根据vendor-class-identifier来对客户端进行分类处理。而IPv6场景中，如果使用同样的方法对客户端分类，则分类并不会生效。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>dhclient -6 &lt;interface&gt; -V &lt;vendor-class-identifier string&gt; &lt;interface&gt;</span></span></code></pre></td></tr></table></div></div><p>这是由于DHCPv6和DHCP协议存在较大差异，DHCPv6的可选项中使用vendor-class-option替代了DHCP中的vendor-class-identifier。而dhclient的-V选项并不能设置vendor-class-option。</p></li></ul><h5 class=heading-element id=有状态自动配置ipv6地址时dhclient设置vendor-class方法><span>有状态自动配置IPv6地址时dhclient设置vendor class方法</span>
<a href=#%e6%9c%89%e7%8a%b6%e6%80%81%e8%87%aa%e5%8a%a8%e9%85%8d%e7%bd%aeipv6%e5%9c%b0%e5%9d%80%e6%97%b6dhclient%e8%ae%be%e7%bd%aevendor-class%e6%96%b9%e6%b3%95 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><ul><li><p>在客户端使用配置文件方式添加对vendor class的设置，使用方法如下：</p><p>客户端配置文件（/etc/dhcp/dhclient6.conf），文件位置可以自定义，在使用时需要通过dhclient -cf选项来指定配置文件：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>option dhcp6.vendor-class code 16 = {integer 32, integer 16, string};
</span></span><span class=line><span class=cl>interface &#34;enp3s0&#34; {
</span></span><span class=line><span class=cl>        send dhcp6.vendor-class &lt;Enterprise-ID number&gt; &lt;vendor class string length&gt; &lt;vendor class string&gt;;
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div><p>说明：</p><ul><li><enterprise-id number>，32位整型数字，企业标识号，企业通过IANA注册。</li><li><vendor class string length>，16位整型数字，vendor class字符串长度。</li><li><vendor class string>，要设置的vendor class字符串，例如：“HWHW”。</li></ul><p>客户端使用方法：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>dhclient -6 &lt;interface&gt; -cf /etc/dhcp/dhclient6.conf</span></span></code></pre></td></tr></table></div></div></li><li><p>DHCPv6服务端配置文件（/etc/dhcp/dhcpd6.conf），需要dhcpd -cf选项来指定该配置文件：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>option dhcp6.vendor-class code 16 = {integer 32, integer 16, string};
</span></span><span class=line><span class=cl>subnet6 fc00:4:12:ffff::/64 {
</span></span><span class=line><span class=cl>        class &#34;hw&#34; {
</span></span><span class=line><span class=cl>                match if substring ( option dhcp6.vendor-class, 6, 10 ) = &#34;HWHW&#34;;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>        pool6 {
</span></span><span class=line><span class=cl>                allow members of &#34;hw&#34;;
</span></span><span class=line><span class=cl>                range6 fc00:4:12:ffff::ff10 fc00:4:12:ffff::ff20;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>        pool6 {
</span></span><span class=line><span class=cl>                allow unknown clients;
</span></span><span class=line><span class=cl>                range6 fc00:4:12:ffff::100 fc00:4:12:ffff::120;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div><p>说明：</p><p>substring ( option dhcp6.vendor-class, 6, 10 ) 其中子字符串的开始位置为6，因为前面包含4个字节的<enterprise-id number>和2个字节的<string length>。而子字符串的结束位置为：6+<vendor class string length>。这里vendor class string为“HWHW”，字符串的长度为4，所以子字符串的结束位置为6+4=10。用户可以根据实际需要来确定<vendor class string>及相应的<vendor class string length>。</p><p>服务端使用方法：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>dhcpd -6 -cf /etc/dhcp/dhcpd6.conf &lt;interface&gt;</span></span></code></pre></td></tr></table></div></div></li></ul><h4 class=heading-element id=内核支持socket相关系统调用><span>内核支持socket相关系统调用</span>
<a href=#%e5%86%85%e6%a0%b8%e6%94%af%e6%8c%81socket%e7%9b%b8%e5%85%b3%e7%b3%bb%e7%bb%9f%e8%b0%83%e7%94%a8 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h5 class=heading-element id=概述-2><span>概述</span>
<a href=#%e6%a6%82%e8%bf%b0-2 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>IPv6地址长度扩展到128比特，所以有足够的IPv6地址可供分配使用。同时IPv6头相比IPv4头进行了简化，并增强了IPv6的自动配置功能。IPv6地址分为单播地址，组播地址和任意播地址。常用的单播地址又包含：链路本地地址（link-local address），唯一本地地址（Unique local address）和全局地址（global address）。由于IPv6的全局地址十分充足，唯一本地地址一般不被使用（其前身为站点本地地址（site-local address），已于2004年被废弃）。当前主要使用的单播地址为：链路本地地址（link-local address）和全局地址（global address）。当前内核支持socket系统调用，在使用单播地址的链路本地地址和全局地址时存在差异。</p><h5 class=heading-element id=link-local地址和global地址在socket调用时的差异><span>link-local地址和global地址在socket调用时的差异</span>
<a href=#link-local%e5%9c%b0%e5%9d%80%e5%92%8cglobal%e5%9c%b0%e5%9d%80%e5%9c%a8socket%e8%b0%83%e7%94%a8%e6%97%b6%e7%9a%84%e5%b7%ae%e5%bc%82 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>RFC 2553： Basic Socket Interface Extensions for IPv6 定义sockaddr_in6的数据结构如下；</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>struct sockaddr_in6 {     
</span></span><span class=line><span class=cl>    uint8_t         sin6_len;       /* length of this struct */     
</span></span><span class=line><span class=cl>    sa_family_t     sin6_family;    /* AF_INET6 */     
</span></span><span class=line><span class=cl>    in_port_t       sin6_port;      /* transport layer port # */     
</span></span><span class=line><span class=cl>    uint32_t        sin6_flowinfo;  /* IPv6 flow information */     
</span></span><span class=line><span class=cl>    struct in6_addr sin6_addr;      /* IPv6 address */     
</span></span><span class=line><span class=cl>    uint32_t        sin6_scope_id;  /* set of interfaces for a scope */ 
</span></span><span class=line><span class=cl>};</span></span></code></pre></td></tr></table></div></div><p>说明：</p><p>sin6_scope_id： 32位整型，对于链路本地地址（link-local address），对于链路范围的sin6_addr，它可以用来标识指定的接口索引号。如果是站点范围的sin6_addr，则用来作为站点的标识符（站点本地地址已被抛弃）。</p><p>在使用link-local地址进行socket通信时，在构造目的地址时，需要指定该地址所对应的接口索引号。一般可以通过if_nametoindex函数将接口名转化为接口索引号。具体方式如下，</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>int port = 1234;
</span></span><span class=line><span class=cl>int sk_fd;
</span></span><span class=line><span class=cl>int iff_index = 0;
</span></span><span class=line><span class=cl>char iff_name[100] = &#34;enp3s0&#34;;
</span></span><span class=line><span class=cl>char * ll_addr[100] = &#34;fe80::123:456:789&#34;;
</span></span><span class=line><span class=cl>struct sockaddr_in6 server_addr;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>memset(&amp;server_addr,0,sizeof(structsockaddr_in6));
</span></span><span class=line><span class=cl>iff_index=if_nametoindex(iff_name);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>server_addr.sin6_family=AF_INET6;
</span></span><span class=line><span class=cl>server_addr.sin6_port=htons(port);
</span></span><span class=line><span class=cl>server_addr.sin6_scope_id=iff_index;
</span></span><span class=line><span class=cl>inet_pton(AF_INET6, ll_addr, &amp;(server_addr.sin6_addr));
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sk_fd=socket(AF_INET6, SOCK_STREAM, IPPROTO_TCP);
</span></span><span class=line><span class=cl>connect(sk_fd, (struct sockaddr *)&amp;server_addr, sizeof(struct sockaddr_in6));</span></span></code></pre></td></tr></table></div></div><h4 class=heading-element id=ipv4的dhclient守护进程持久化配置><span>IPv4的dhclient守护进程持久化配置</span>
<a href=#ipv4%e7%9a%84dhclient%e5%ae%88%e6%8a%a4%e8%bf%9b%e7%a8%8b%e6%8c%81%e4%b9%85%e5%8c%96%e9%85%8d%e7%bd%ae class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h5 class=heading-element id=概述-3><span>概述</span>
<a href=#%e6%a6%82%e8%bf%b0-3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>通过NetworkManager服务来管理网络服务时，如果接口ifcfg-<interface-name>配置文件中配置了DHCP方式获得IP地址，则相应地NetworkManager服务会拉起dhclient守护进程来通过DHCP协议方式来从DHCP服务器获取IP地址。</p><p>dhclient提供了"-1"选项来决定dhclient进程在未获得DHCP服务响应时，是会不断持久化尝试请求地址还是会尝试时间超时后退出。针对IPv4的dhclient守护进程，可以在ifcfg-<interface-name>配置文件中设置PERSISTENT_DHCLIENT来决定是否设置IPv4的dhclient进程的持久化。</p><h5 class=heading-element id=约束限制><span>约束限制</span>
<a href=#%e7%ba%a6%e6%9d%9f%e9%99%90%e5%88%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><ol><li>当dhclient进程在运行中被杀死，network服务无法自动将其拉起，可靠性需要用户自己保障。</li><li>配置了持久化选项PERSISTENT_DHCLIENT，需要确保有相应的DHCP服务器。如果在拉起network时无可用DHCP服务器，dhclient进程不断尝试发送请求包但无回应，则会导致network服务卡死直到network服务超时失败。由于network服务在拉起多个网卡的IPv4 dhclient进程时，是通过串行的方式来拉起的。如果有网卡配置了持久化而DHCP服务器没有准备好，则会导致network服务在给该网卡获取IPv4地址超时卡死，进而导致后续网卡无法获得IPv4/IPv6地址。</li></ol><p>以上两种约束限制是特殊的应用场景，需要用户自己进行可靠性保障。</p><h5 class=heading-element id=ipv4-dhcp和ipv6-dhcpv6方式获取地址的配置差异><span>IPv4 DHCP和IPv6 DHCPv6方式获取地址的配置差异</span>
<a href=#ipv4-dhcp%e5%92%8cipv6-dhcpv6%e6%96%b9%e5%bc%8f%e8%8e%b7%e5%8f%96%e5%9c%b0%e5%9d%80%e7%9a%84%e9%85%8d%e7%bd%ae%e5%b7%ae%e5%bc%82 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>可以通过配置接口ifcfg-<interface-name>参数来分别实现IPv4和IPv6通过DHCP/DHCPv6协议来动态获取IP地址，具体配置说明如下；</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>BOOTPROTO=none|bootp|dhcp
</span></span><span class=line><span class=cl>DHCPV6C=yes|no
</span></span><span class=line><span class=cl>PERSISTENT_DHCLIENT=yes|no|1|0</span></span></code></pre></td></tr></table></div></div><ul><li><p>BOOTPROTO： none表示静态配置IPv4地址，bootp|dhcp则会拉起DHCP dhclient来动态获取IPv4地址。</p></li><li><p>DHCPV6C： no表示静态配置IPv6地址，yes则会拉起DHCPv6 dhclient来动态获取IPv6地址。</p></li><li><p>PERSISTENT_DHCLIENT：no|0表示IPv4的dhclient进程配置为“非持久化”，当dhclient向DHCP服务器发送一次请求报文而无响应，则会间隔一段时间后退出，退出值为2。yes|1则表示IPv4的dhclient进程配置为“持久化”，dhclient会向DHCP服务器反复发送请求报文。<strong>如果没有配置PERSISTENT_DHCLIENT项，则IPv4的dhclient会默认设置为“持久化”</strong>。</p><p>说明：</p><p>PERSISTENT_DHCLIENT配置只针对IPv4生效，对IPv6相关dhclient -6进程不生效，IPv6默认不进行持久化配置。</p></li></ul><h4 class=heading-element id=iproute相关命令配置ipv4与ipv6时的差异说明><span>iproute相关命令配置IPv4与IPv6时的差异说明</span>
<a href=#iproute%e7%9b%b8%e5%85%b3%e5%91%bd%e4%bb%a4%e9%85%8d%e7%bd%aeipv4%e4%b8%8eipv6%e6%97%b6%e7%9a%84%e5%b7%ae%e5%bc%82%e8%af%b4%e6%98%8e class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h5 class=heading-element id=概述-4><span>概述</span>
<a href=#%e6%a6%82%e8%bf%b0-4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>由于IPv4和IPv6是两个不同的协议标准，iproute相关命令在使用方法上存在一定的差异。本章节主要梳理iproute包中用户经常使用到命令在IPv4和IPv6使用方面的差异，从而可以更好地指导用户使用iproute包中相关命令。</p><p>iproute相关命令均需要在root权限下运行。</p><h5 class=heading-element id=ipv6地址的生命周期><span>IPv6地址的生命周期</span>
<a href=#ipv6%e5%9c%b0%e5%9d%80%e7%9a%84%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><table><thead><tr><th style=text-align:left><strong>IPv6状态</strong></th><th style=text-align:left><strong>解释</strong></th></tr></thead><tbody><tr><td style=text-align:left>tentative</td><td style=text-align:left>临时状态：刚添加地址还处于地址重复检测DAD过程。</td></tr><tr><td style=text-align:left>preferred</td><td style=text-align:left>首选状态：完成DAD过程，没有收到相应的NA报文，表示该地址没有冲突。</td></tr><tr><td style=text-align:left>deprecated</td><td style=text-align:left>弃用状态：地址有一定的使用时限（valid_lft和preferred_lft），preferred_lft到期后地址会变化deprecated状态。该状态下的地址不能用于创建新的连接，但是原有的连接可以继续使用。</td></tr><tr><td style=text-align:left>invalid</td><td style=text-align:left>无效状态：使用时限超过preferred_lft一段时间后仍然没有成功进行租约续约，则valid_lft时间到后地址状态会被设置为invalid，表示该地址不可以再被使用。</td></tr></tbody></table><p>其他说明：</p><ul><li>preferred_lft：preferred lifetime，地址为首选状态的寿命，preferred_lft没有到期的地址可以用于正常通信使用，若有多个preferred地址则按照内核具体机制选择地址。</li><li>valid_lft： valid lifetime，地址有效的寿命，在[preferred_lft, valid_lft]时间段内该地址不能被用于新建连接，已经创建的连接继续有效。</li></ul><h5 class=heading-element id=ip-link-命令><span>ip link 命令</span>
<a href=#ip-link-%e5%91%bd%e4%bb%a4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ip link set IFNAME mtu MTU</span></span></code></pre></td></tr></table></div></div><p>IPv6中PMTU的最小值为1280，如果mtu值设置小于1280则会导致IPv6地址丢失。其他设备无法ping通该IPv6地址。</p><h5 class=heading-element id=ip-addr命令><span>ip addr命令</span>
<a href=#ip-addr%e5%91%bd%e4%bb%a4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><ol><li><p>命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip [-6] addr add IFADDR dev IFNAME</span></span></code></pre></td></tr></table></div></div><p>添加IPv6地址可以选择添加-6选项也可以不添加，ip addr命令会根据具体地址类型来判断是ipv4地址还是IPv6地址。</p><p>如果指定“-6”选项，但是IFADDR 是ipv4地址则会有错误返回。</p></li><li><p>命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip [-6] addr add IFADDR  dev IFNAME [home|nodad]</span></span></code></pre></td></tr></table></div></div><p>[home|nodad] 选项只针对IPv6地址有效。</p><ul><li>home：将该地址指定为RFC 6275中定义的家庭地址。（这是移动节点从家庭链路获取的地址， 是移动节点的永久地址，如果移动节点保持在相同的归属链路中，则各种实体之间的通信照常进行。）</li><li>nodad：配置该项（仅限IPv6）添加此地址时不执行重复地址检测DAD（RFC 4862）。如果一台设备上多个接口通过nodad配置了多个相同的IPv6地址，则会按照接口顺序使用该IPv6地址。同一个接口上不能添加一个nodad一个非nodad的相同IPv6地址。因为两个地址是一样的，所以会报“RTNETLINK answers: File exists”。</li></ul></li><li><p>命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip [-6] addr del IFADDR dev IFNAME</span></span></code></pre></td></tr></table></div></div><p>删除IPv6地址可以选择添加-6选项也可以不添加，ip addr del命令会根据具体地址类型来判断是ipv4地址还是IPv6地址。</p></li><li><p>命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip [-6] addr show dev IFNAME [tentative|-tentative|deprecated|-deprecated|dadfailed|-dadfailed|temporary]</span></span></code></pre></td></tr></table></div></div><ul><li>不指定-6选项，则会同时打印IPv4和IPv6地址。指定-6选项则只打印IPv6地址。</li><li>[tentative|-tentative|deprecated|-deprecated|dadfailed|-dadfailed|temporary]，这些选项只针对IPv6，可以根据IPv6地址状态对地址进行筛选查看。<ol><li>tentative：（仅限IPv6）仅列出尚未通过重复地址检测的地址。</li><li>-tentative：（仅限IPv6）仅列出当前未处于重复地址检测过程中的地址。</li><li>deprecated：（仅限IPv6）仅列出已弃用的地址。</li><li>-deprecated：（仅限IPv6）仅列出未弃用的地址。</li><li>dadfailed：（仅限IPv6）仅列出重复地址检测失败的地址。</li><li>-dadfailed：（仅限IPv6）仅列出未重复地址检测失败的地址。</li><li>temporary：（仅限IPv6）仅列出临时地址</li></ol></li></ul></li></ol><h5 class=heading-element id=ip-route命令><span>ip route命令</span>
<a href=#ip-route%e5%91%bd%e4%bb%a4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><ol><li><p>命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip [-6] route add ROUTE [mtu lock MTU]</span></span></code></pre></td></tr></table></div></div><ul><li>-6选项：添加IPv6路由可以选择添加-6选项也可以不添加，ip route命令会根据具体地址类型来判断是IPv4地址还是IPv6地址。</li><li>mtu lock MTU：锁定路由的MTU值。如果不锁定MTU，则MTU的值则可能在PMTUD过程中被内核改变。如果锁定MTU，则不会尝试PMTUD，所有IPv4包都将不设置DF位发出，IPv6包则会按照MTU进行分段处理。</li></ul></li><li><p>命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip [-6] route del ROUTE</span></span></code></pre></td></tr></table></div></div><p>删除IPv6路由可以选择添加-6选项也可以不添加，ip route命令会根据具体地址类型来判断是IPv4地址还是IPv6地址。</p></li></ol><h5 class=heading-element id=ip-rule命令><span>ip rule命令</span>
<a href=#ip-rule%e5%91%bd%e4%bb%a4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><ol><li><p>命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip [-6] rule list</span></span></code></pre></td></tr></table></div></div><p>-6选项：设置-6选项打印IPv6的策略路由，不设置-6选项打印IPv4的策略路由。所以需要根据具体协议类型来配置-6选项。</p></li><li><p>命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ip [-6] rule [add|del] [from|to] ADDR table TABLE pref PREF</span></span></code></pre></td></tr></table></div></div><p>-6选项：IPv6相关的策略路由表项需要设置-6选项，否则会报错：“Error: Invalid source address.”。相应地，IPv4相关的策略路由表项不可以设置-6选项，否则会报错：“Error: Invalid source address.”。</p></li></ol><h4 class=heading-element id=networkmanager服务配置差异说明><span>NetworkManager服务配置差异说明</span>
<a href=#networkmanager%e6%9c%8d%e5%8a%a1%e9%85%8d%e7%bd%ae%e5%b7%ae%e5%bc%82%e8%af%b4%e6%98%8e class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h5 class=heading-element id=概述-5><span>概述</span>
<a href=#%e6%a6%82%e8%bf%b0-5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>NetworkManager服务使用ifup/ifdown的逻辑接口定义进行高级网络设置。其参数大多数都是在/etc/sysconfig/network和/etc/sysconfig/network-scripts/ifcfg-<interface-name>两个配置文件设置。前者为全局设置，后者为指定网卡的设置，当两者有冲突时，后者生效。</p><h5 class=heading-element id=配置差异说明><span>配置差异说明</span>
<a href=#%e9%85%8d%e7%bd%ae%e5%b7%ae%e5%bc%82%e8%af%b4%e6%98%8e class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>其中在/etc/sysconfig/network下的配置差异有：</p><table><thead><tr><th style=text-align:left><strong>IPv4</strong></th><th style=text-align:left><strong>IPv6</strong></th><th style=text-align:left><strong>含义说明</strong></th></tr></thead><tbody><tr><td style=text-align:left>NA</td><td style=text-align:left>IPV6FORWARDING=yes|no</td><td style=text-align:left>IPv6转发，默认不转发。</td></tr><tr><td style=text-align:left>NA</td><td style=text-align:left>IPV6_AUTOCONF=yes|no</td><td style=text-align:left>IPv6转发打开是no，否则是yes。</td></tr><tr><td style=text-align:left>NA</td><td style=text-align:left>IPV6_ROUTER=yes|no</td><td style=text-align:left>IPv6转发打开是yes，否则是no。</td></tr><tr><td style=text-align:left>NA</td><td style=text-align:left>IPV6_AUTOTUNNEL=yes|no</td><td style=text-align:left>指定Tunnel为自动隧道模式，默认是no。</td></tr><tr><td style=text-align:left>GATEWAY</td><td style=text-align:left>IPV6_DEFAULTGW=&lt;IPv6 address[%interface]> (optional)</td><td style=text-align:left>在IPv6中设置默认网关。</td></tr><tr><td style=text-align:left>NA</td><td style=text-align:left>IPV6_DEFAULTDEV=<interface> (optional)</td><td style=text-align:left>指定默认转发的网卡。</td></tr><tr><td style=text-align:left>NA</td><td style=text-align:left>IPV6_RADVD_PIDFILE=<pid-file> (optional)</td><td style=text-align:left>默认ipv6_radvd_pid路径：/var/run/radvd/radvd.pid。</td></tr><tr><td style=text-align:left>NA</td><td style=text-align:left>IPV6_RADVD_TRIGGER_ACTION=startstop|reload|restart|SIGHUP (optional)</td><td style=text-align:left>radvd默认触发动作。</td></tr></tbody></table><p>而在/etc/sysconfig/network-scripts/ifcfg-<interface-name>下的差异主要有：</p><table><thead><tr><th style=text-align:left><strong>IPv4</strong></th><th style=text-align:left><strong>IPv6</strong></th><th style=text-align:left><strong>含义说明</strong></th></tr></thead><tbody><tr><td style=text-align:left>IPADDRn</td><td style=text-align:left>IPV6ADDR=<ipv6 address>[/<prefix length>]</td><td style=text-align:left>ip地址。</td></tr><tr><td style=text-align:left>PREFIXn</td><td style=text-align:left>NA</td><td style=text-align:left>网络前缀，网络别名和ppp无效，优先级高于NETMASK。</td></tr><tr><td style=text-align:left>NETMASKn</td><td style=text-align:left>NA</td><td style=text-align:left>子网掩码，仅用于别名和ppp。</td></tr><tr><td style=text-align:left>GATEWAY</td><td style=text-align:left>IPV6_DEFAULTGW=&lt;IPv6 address[%interface]> (optional)</td><td style=text-align:left>默认网关。</td></tr><tr><td style=text-align:left>MTU</td><td style=text-align:left>IPV6_MTU=<mtu of link> (optional)</td><td style=text-align:left>默认MTU。</td></tr><tr><td style=text-align:left>IPV4_FAILURE_FATAL=yes|no</td><td style=text-align:left>IPV6_FAILURE_FATAL</td><td style=text-align:left>缺省值是no。若设置为yes，dhclient失败ifup-eth会直接退出。</td></tr><tr><td style=text-align:left>NA</td><td style=text-align:left>IPV6_PRIVACY=rfc3041</td><td style=text-align:left>默认禁用。</td></tr><tr><td style=text-align:left>NA</td><td style=text-align:left>IPV6INIT=yes|no</td><td style=text-align:left>默认开启IPv6。</td></tr><tr><td style=text-align:left>NA</td><td style=text-align:left>IPV6FORWARDING=yes|no</td><td style=text-align:left>默认关闭，已废弃。</td></tr></tbody></table><h3 class=heading-element id=faq><span>FAQ</span>
<a href=#faq class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><h4 class=heading-element id=iscsi-initiator-utils不支持登录fe80-ipv6地址><span>iscsi-initiator-utils不支持登录fe80 IPv6地址</span>
<a href=#iscsi-initiator-utils%e4%b8%8d%e6%94%af%e6%8c%81%e7%99%bb%e5%bd%95fe80-ipv6%e5%9c%b0%e5%9d%80 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h5 class=heading-element id=问题现象><span>问题现象</span>
<a href=#%e9%97%ae%e9%a2%98%e7%8e%b0%e8%b1%a1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>客户端通过IPv6登录iscsi服务端时，使用如“iscsiadm -m node -p ipv6address -l”的命令格式登录，如果是全局地址（global address），直接替换将命令范例中的“ipv6address”替换为全局地址即可；但如果是链路本地地址（link-local address，fe80开头的IPv6地址）则无法使用，因为iscsi-initiator-utils目前机制还不支持用链路本地地址（link-local address）地址登录iscsi服务端。</p><h5 class=heading-element id=原因分析><span>原因分析</span>
<a href=#%e5%8e%9f%e5%9b%a0%e5%88%86%e6%9e%90 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>如果使用格式如“iscsiadm -m node -p fe80::xxxx -l”登录，会登录超时返回，这是因为使用链路本地地址必须指定接口，否则使用iscsi_io_tcp_connect函数调用connect函数会失败，并且产生标准错误码22。</p><p>如果使用格式如“iscsiadm -m node -p fe80::xxxx%enp3s0 -l”登录时，iscsi_addr_match函数会将地址“fe80::xxxx%enp3s0”与服务端返回的node信息中的地址“fe80::xxxx”对比，对比结果不匹配，导致登录失败。</p><p>因此，<strong>iscsi-initiator-utils目前机制还不支持用链路本地地址（link-local address）登录iscsi服务端</strong>。</p><h4 class=heading-element id=网卡down掉之后ipv6地址丢失><span>网卡down掉之后，IPv6地址丢失</span>
<a href=#%e7%bd%91%e5%8d%a1down%e6%8e%89%e4%b9%8b%e5%90%8eipv6%e5%9c%b0%e5%9d%80%e4%b8%a2%e5%a4%b1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h5 class=heading-element id=问题现象-1><span>问题现象</span>
<a href=#%e9%97%ae%e9%a2%98%e7%8e%b0%e8%b1%a1-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>通过ip link down+up网卡或ifconfig down+up网卡命令，将网卡down掉之后再上线，查看网卡上配置的ip地址，发现ipv4地址不丢失，而配置的IPv6地址丢失。</p><h5 class=heading-element id=原因分析-1><span>原因分析</span>
<a href=#%e5%8e%9f%e5%9b%a0%e5%88%86%e6%9e%90-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>内核中的处理逻辑为如果网卡设置为down状态，会清空所有IPv4及IPv6地址，将网卡重新up之后，ipv4地址自动恢复，网卡上自动配置的IPv6链路本地地址也会恢复，但是其他IPv6地址默认会丢失。如果需要保留这些IPv6地址，可以通过“sysctl -w net.ipv6.conf.&lt;网卡名>.keep_addr_on_down=1”来实现。</p><h4 class=heading-element id=bond口已具有多个ipv6地址时添加或删除ipv6地址耗时过久><span>bond口已具有多个IPv6地址时，添加或删除IPv6地址耗时过久</span>
<a href=#bond%e5%8f%a3%e5%b7%b2%e5%85%b7%e6%9c%89%e5%a4%9a%e4%b8%aaipv6%e5%9c%b0%e5%9d%80%e6%97%b6%e6%b7%bb%e5%8a%a0%e6%88%96%e5%88%a0%e9%99%a4ipv6%e5%9c%b0%e5%9d%80%e8%80%97%e6%97%b6%e8%bf%87%e4%b9%85 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h5 class=heading-element id=问题现象-2><span>问题现象</span>
<a href=#%e9%97%ae%e9%a2%98%e7%8e%b0%e8%b1%a1-2 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>下列方式配置或删除（包括flush）IPv6地址，X为动态变化的低16位，并且配置在bond口时，耗时会随已配置的IPv6地址数量成倍增加。例如由4个物理网卡组成的bond口添加IPv6地址时，单线程添加删除3000个IPv6地址均需大概5分钟，而普通物理网卡耗时在10秒内。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ip a add/del 192:168::18:X/64 dev DEVICE</span></span></code></pre></td></tr></table></div></div><h5 class=heading-element id=原因分析-2><span>原因分析</span>
<a href=#%e5%8e%9f%e5%9b%a0%e5%88%86%e6%9e%90-2 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>bond口在添加IPv6地址时，会生成IPv6组播地址，并进行同步到所有的物理网卡上，此耗时会随IPv6数量增加而增加，导致耗时过长。</p><h5 class=heading-element id=解决方法><span>解决方法</span>
<a href=#%e8%a7%a3%e5%86%b3%e6%96%b9%e6%b3%95 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>IPv6的组播地址是由IPv6地址的低24位与33-33-ff组合生成，组播地址过多会导致添加删除耗时增加，如果生成的组播地址为少量，耗时不会受此影响。</p><p>建议添加IPv6地址时，可保持低24位一致，保持高位变动，单网卡中仅需一个网段的一个地址即可与外部正常通信，此配置更符合常规使用。</p><h4 class=heading-element id=rsyslog在ipv4和ipv6混合使用场景中日志传输延迟><span>Rsyslog在IPv4和IPv6混合使用场景中日志传输延迟</span>
<a href=#rsyslog%e5%9c%a8ipv4%e5%92%8cipv6%e6%b7%b7%e5%90%88%e4%bd%bf%e7%94%a8%e5%9c%ba%e6%99%af%e4%b8%ad%e6%97%a5%e5%bf%97%e4%bc%a0%e8%be%93%e5%bb%b6%e8%bf%9f class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h5 class=heading-element id=问题现象-3><span>问题现象</span>
<a href=#%e9%97%ae%e9%a2%98%e7%8e%b0%e8%b1%a1-3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>rsyslog客户端配置文件同时配置IPv4和IPv6地址，且端口配置相同的情况下，服务端收集log时会概率性出现日志打印延迟。</p><h5 class=heading-element id=原因分析-3><span>原因分析</span>
<a href=#%e5%8e%9f%e5%9b%a0%e5%88%86%e6%9e%90-3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>延迟是因为rsyslog内部存在缓冲队列机制，默认情况下需要缓冲区队列达到一定数量才会写入文件。</p><h5 class=heading-element id=解决方法-1><span>解决方法</span>
<a href=#%e8%a7%a3%e5%86%b3%e6%96%b9%e6%b3%95-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>可在root权限下通过配置Direct模式，关闭缓冲队列机制解决该问题。在rsyslog远程传输服务端的/etc/rsyslog.d目录下新增的远程传输配置文件中，最开头增加如下配置：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># ActionQueueType Direct
</span></span><span class=line><span class=cl># MainMsgQueueType Direct</span></span></code></pre></td></tr></table></div></div><p>说明：</p><ul><li>Direct模式减少队列大小为1，所以在队列中会保留1条日志到下次日志打印；</li><li>Direct模式会降低服务器端的rsyslog性能。</li></ul><h2 class=heading-element id=系统资源性能查看><span>系统资源性能查看</span>
<a href=#%e7%b3%bb%e7%bb%9f%e8%b5%84%e6%ba%90%e6%80%a7%e8%83%bd%e6%9f%a5%e7%9c%8b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h2 class=heading-element id=cpu><span>CPU</span>
<a href=#cpu class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=基本概念><span>基本概念</span>
<a href=#%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>中央处理器（Central Processing Unit，简称CPU）是计算机的主要设备之一，其功能是解释计算机指令以及处理计算机软件中的数据。</p><ol><li>物理核：可以真实看到的CPU核，有独立的电路元件以及L1、L2缓存，可以独立地执行指令。一个CPU可以有多个物理核。</li><li>逻辑核：在同一个物理核内，逻辑层面上存在的核。一般一个物理核对应一个线程，但是如果开启了超线程，当超线程数量为n时，一个物理核可以分成n个逻辑核。可以通过lscpu命令查看服务器中有多少个CPU，每个CPU中有几个物理核，以及每个CPU有几个逻辑核。</li></ol><h3 class=heading-element id=常用cpu性能分析工具><span>常用CPU性能分析工具</span>
<a href=#%e5%b8%b8%e7%94%a8cpu%e6%80%a7%e8%83%bd%e5%88%86%e6%9e%90%e5%b7%a5%e5%85%b7 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><ol><li><p>uptime：可用于<strong>打印系统平均负载</strong>，通过查看最后三个数字，可以判断平均负载的变化趋势。 平均负载大于CPU数量时表示CPU不足以服务线程，部分线程在等待；平均负载小于CPU数量，代表当前还有余量。</p><p><img loading=lazy src=https://docs.openeuler.openatom.cn/assets/24.03_LTS_SP1/zh-cn_image_0000001384808269.CjnTXZKx.png alt=zh-cn_image_0000001384808269></p></li><li><p>vmstat：可以<strong>动态地了解系统资源的使用情况</strong>，以及查看系统中是哪一个环节最占用系统资源。 通过<strong>vmstat -h</strong>命令可以查看命令详解参数。 例如：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1>#使用vmstat进行监测，每隔1秒刷新一次</span>
</span></span><span class=line><span class=cl>vmstat <span class=m>1</span></span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=https://docs.openeuler.openatom.cn/assets/24.03_LTS_SP1/zh-cn_image_0000001385585749.Rvm16HI4.png alt=img></p><p>在命令的输出信息中，各字段所代表的含义如下：</p><table><thead><tr><th style=text-align:left>字段</th><th style=text-align:left>含义</th></tr></thead><tbody><tr><td style=text-align:left>procs</td><td style=text-align:left>进程信息字段。</td></tr><tr><td style=text-align:left>memory</td><td style=text-align:left>内存信息字段。</td></tr><tr><td style=text-align:left>swap</td><td style=text-align:left>交换分区信息字段。</td></tr><tr><td style=text-align:left>io</td><td style=text-align:left>磁盘读/写信息字段。</td></tr><tr><td style=text-align:left>system</td><td style=text-align:left>系统信息字段。</td></tr><tr><td style=text-align:left>cpu</td><td style=text-align:left>CPU信息字段。-us：非内核进程消耗 CPU 运算时间的百分比。-sy：内核进程消耗 CPU 运算时间的百分比。-id：空闲。-wa：等待 I/O 所消耗的 CPU 百分比。-st：被虚拟机所盗用的 CPU 百分比。</td></tr></tbody></table></li><li><p>ps：可用于<strong>查看正在运行的进程</strong>。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 查看系统中所有的进程，以及查看进程的父进程的 PID 和进程优先级</span>
</span></span><span class=line><span class=cl>ps -le</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=https://docs.openeuler.openatom.cn/assets/24.03_LTS_SP1/zh-cn_image_0000001337039920.COTJk8z5.png alt=zh-cn_image_0000001337039920></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 查看当前shell产生的进程</span>
</span></span><span class=line><span class=cl>ps -l</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=https://docs.openeuler.openatom.cn/assets/24.03_LTS_SP1/zh-cn_image_0000001385611905.BSMWWOyO.png alt=zh-cn_image_0000001385611905></p></li><li><p>top：可以<strong>动态地持续监听进程的运行状态，显示最消耗CPU的进程</strong>。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>top</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=https://docs.openeuler.openatom.cn/assets/24.03_LTS_SP1/zh-cn_image_0000001335457246.9pQIhMEl.png alt=zh-cn_image_0000001335457246></p></li></ol><h2 class=heading-element id=内存><span>内存</span>
<a href=#%e5%86%85%e5%ad%98 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=基本概念-1><span>基本概念</span>
<a href=#%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5-1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p><strong>内存</strong>是计算机的重要组成部件，用于暂时存放CPU中的运算数据，以及与硬件等外部存储器交换的数据。特别地，<strong>非统一内存访问架构</strong>（non-uniform memory access，简称NUMA）是一种为多处理器的电脑设计的内存架构，<strong>内存访问时间取决于内存相对于处理器的位置</strong>。在NUMA下，处理器访问本地内存的速度比非本地内存速度（内存位于另一个处理器，或者是处理器之间共享的内存）快。</p><h3 class=heading-element id=常用内存分析工具方式><span>常用内存分析工具/方式</span>
<a href=#%e5%b8%b8%e7%94%a8%e5%86%85%e5%ad%98%e5%88%86%e6%9e%90%e5%b7%a5%e5%85%b7%e6%96%b9%e5%bc%8f class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><ol><li><p>free：可用于<strong>显示系统内存状态</strong>。</p><p>例如：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 显示系统内存状态，以MB单位显示</span>
</span></span><span class=line><span class=cl>free -m</span></span></code></pre></td></tr></table></div></div><p>回显信息如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@openEuler ~<span class=o>]</span><span class=c1># free -m</span>
</span></span><span class=line><span class=cl>               total        used        free      shared  buff/cache   available
</span></span><span class=line><span class=cl>Mem:            <span class=m>2633</span>         <span class=m>436</span>         <span class=m>324</span>          <span class=m>23</span>        <span class=m>2072</span>        <span class=m>2196</span>
</span></span><span class=line><span class=cl>Swap:           <span class=m>4043</span>           <span class=m>0</span>        <span class=m>4043</span></span></span></code></pre></td></tr></table></div></div><p>在命令的输出信息中，各字段所代表的含义如下：</p><table><thead><tr><th style=text-align:left>标识</th><th style=text-align:left>含义</th></tr></thead><tbody><tr><td style=text-align:left>total</td><td style=text-align:left>总内存数。</td></tr><tr><td style=text-align:left>used</td><td style=text-align:left>已经使用的内存数。</td></tr><tr><td style=text-align:left>free</td><td style=text-align:left>空闲的内存数。</td></tr><tr><td style=text-align:left>shared</td><td style=text-align:left>多个进程共享的内存总数。</td></tr><tr><td style=text-align:left>buff/cache</td><td style=text-align:left>缓冲和缓存内存总数。</td></tr><tr><td style=text-align:left>available</td><td style=text-align:left>估计有多少内存可用于启动新应用程序，而不交换。</td></tr></tbody></table></li><li><p>vmstat：可以<strong>动态地监控系统内存</strong>，查看系统内存的使用情况。</p><p>例如：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 监测系统内存，显示活跃和非活跃内存</span>
</span></span><span class=line><span class=cl>vmstat -a</span></span></code></pre></td></tr></table></div></div><p>回显信息如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@openEuler ~<span class=o>]</span><span class=c1># vmstat -a</span>
</span></span><span class=line><span class=cl>procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----
</span></span><span class=line><span class=cl>r  b   swpd   free  inact active   si   so    bi    bo   in   cs us sy id wa st
</span></span><span class=line><span class=cl><span class=m>2</span>  <span class=m>0</span>    <span class=m>520</span> <span class=m>331980</span> <span class=m>1584728</span> <span class=m>470332</span>    <span class=m>0</span>    <span class=m>0</span>     <span class=m>0</span>     <span class=m>2</span>   <span class=m>15</span>   <span class=m>19</span>  <span class=m>0</span>  <span class=m>0</span> <span class=m>100</span>  <span class=m>0</span>  <span class=m>0</span></span></span></code></pre></td></tr></table></div></div><p>在命令的输出信息中，与内存相关的memory字段所代表的含义如下：</p><table><thead><tr><th style=text-align:left>字段</th><th style=text-align:left>含义</th></tr></thead><tbody><tr><td style=text-align:left>memory</td><td style=text-align:left>内存信息字段。-swpd：虚拟内存的使用情况，单位为 KB。-free：空闲的内存容量，单位为 KB。-inact：非活跃的内存容量，单位为 KB。-active：活跃的内存容量，单位为 KB。</td></tr></tbody></table></li></ol><h2 class=heading-element id=io><span>I/O</span>
<a href=#io class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=基本概念-2><span>基本概念</span>
<a href=#%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5-2 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p><strong>I/O</strong>表示输入（Input）/输出（Output），输入指系统接收信号或数据的操作，输出指从系统发出信号或数据的操作。对于CPU 和主存储器的组合，<strong>任何信息传入或传出 CPU/内存组合，就会被认为是 I/O</strong>。</p><h3 class=heading-element id=常用io性能分析工具><span>常用I/O性能分析工具</span>
<a href=#%e5%b8%b8%e7%94%a8io%e6%80%a7%e8%83%bd%e5%88%86%e6%9e%90%e5%b7%a5%e5%85%b7 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><ol><li><p>vmstat</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 使用vmstat进行监测，报告磁盘相关统计信息</span>
</span></span><span class=line><span class=cl>vmstat -d</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=https://docs.openeuler.openatom.cn/assets/24.03_LTS_SP1/zh-cn_image_0000001389098425.DRFGFh3P.png alt=zh-cn_image_0000001389098425></p><p>在命令的输出信息中，各字段所代表的含义如下：</p><table><thead><tr><th style=text-align:left>字段</th><th style=text-align:left>含义</th></tr></thead><tbody><tr><td style=text-align:left>reads</td><td style=text-align:left>-total：已成功完成的读取总数。-merged：分组读取（导致一次I/O）。-sectors：扇区读取成功。-ms：读取花费的毫秒数。</td></tr><tr><td style=text-align:left>writes</td><td style=text-align:left>-total：已成功完成的写入总数。-merged：分组写入（导致一次I/O）。-sectors：写入成功的扇区。-ms：写入所花费的毫秒数。</td></tr><tr><td style=text-align:left>IO</td><td style=text-align:left>-cur：正在进行的 I/O 数。-sec：I/O 所花费的秒数。</td></tr></tbody></table></li></ol></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2025-12-22 06:30:06">更新于 2025-12-22&nbsp;</span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/1455028/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 X" data-sharer=twitter data-url=https://jiang1bo.github.io/posts/1455028/ data-title=Openeuler开箱指南 data-hashtags=draft><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://jiang1bo.github.io/posts/1455028/ data-hashtag=draft><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://jiang1bo.github.io/posts/1455028/ data-title=Openeuler开箱指南><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/draft/ class=post-tag title="标签 - Draft">Draft</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/e7d8135/ class=post-nav-item rel=prev title="Markdown 语法示例"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Markdown 语法示例</a><a href=/posts/9c9909b/ class=post-nav-item rel=next title=Wireshark>Wireshark<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div class=post-reward><div class=comment>Buy me a coffee</div><input type=checkbox class=reward-input name=reward id=fi-reward hidden>
<label class=reward-button for=fi-reward><i class="fa-solid fa-qrcode fa-fw" aria-hidden=true></i>赞赏</label><div class=reward-ways data-mode=static><div><img src=/web-app-manifest-512x512.png alt=微信 height=512 width=512><span data-animation>微信</span></div></div></div></article><aside class=toc id=toc-auto aria-label=目录><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line powered">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.152.2"><img class=hugo-icon src=/images/hugo.min.svg alt="Hugo logo"> Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.3.20"><img class=fixit-icon src=/images/fixit.min.svg alt="FixIt logo"> FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2025</span><span class=author itemprop=copyrightHolder>
<a href=https://jiangbos.top/ target=_blank rel="external nofollow noopener noreferrer">fermi</a></span></div><div class="footer-line statistics"><span class=site-time title=网站运行中……><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden=true></i><span class="run-times ms-1">网站运行中……</span></span></div><div class="footer-line visitor"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div><div class="footer-line beian"><span class=gov>china</span><span class="icp footer-divider">20251129</span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div></div><a href=https://github.com/jiang1bo title="View source on GitHub" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true" width="56" height="56"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><div id=mask></div><noscript><div class=noscript-warning>该网站在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/cookieconsent/cookieconsent.min.js defer></script><script src=https://vercount.one/js async defer></script><script>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:10},comment:{enable:!1},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验。"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/search.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!0,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:30,threshold:.3,type:"fuse",useExtendedSearch:!0},siteTime:"2021-11-11",version:"v0.3.20"}</script><script src=/js/theme.min.js defer></script></body></html>